{% extends 'base.html' %}
{% block title %}Molayman Games â€” Molayman Lottery Foundation{% endblock %}
{% block content %}
  <div class="py-8 w-full px-8 sm:px-12 lg:px-20 xl:px-32">
    <!-- Header -->
    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-8 fade-in">
      <div class="flex items-center gap-4">
        <img 
          src="{{ url_for('static', filename='images/caricatures/games.png') }}" 
          alt="Games" 
          class="w-16 h-16 rounded-xl object-cover caricature"
          onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
        />
        <div class="hidden w-16 h-16 rounded-xl bg-gradient-to-br from-cyan-500/20 to-blue-500/20 items-center justify-center text-3xl">ğŸ®</div>
        <div>
          <h2 class="text-2xl font-bold text-slate-800">Molayman Mini-Games</h2>
          <p class="text-slate-500">Play <strong class="text-gradient">41+ games</strong> to earn discount for {{ app.class_fee.class_name }} (cap 70%)</p>
        </div>
      </div>
      <div class="flex items-center gap-3 flex-wrap">
        {% if streak_days and streak_days > 0 %}
          <div class="card rounded-2xl px-4 py-2 text-center bg-gradient-to-r from-amber-50 to-orange-50 border border-amber-200">
            <div class="text-xs text-amber-500">ğŸ”¥ Streak</div>
            <div class="text-lg font-bold text-amber-600">{{ streak_days }}</div>
          </div>
        {% endif %}

        <div class="card rounded-2xl px-4 py-2 text-center hover-lift">
          <div class="text-xs text-slate-400">ğŸ® Played</div>
          <div class="text-lg font-bold text-primary">{{ plays_this_app }}</div>
        </div>

        {% if weekly_challenge %}
          <div class="card rounded-2xl px-4 py-2 text-center bg-white/90 border border-slate-200">
            <div class="text-xs text-slate-600">Weekly Challenge</div>
            <div class="text-sm font-bold text-slate-900">{{ weekly_challenge.title }}</div>
            <div class="text-xs text-slate-500">{{ weekly_challenge.progress }}/{{ weekly_challenge.target }}</div>
          </div>
        {% endif %}

        <div class="card rounded-2xl px-5 py-3 text-center bg-white/90 border border-slate-200">
          <div class="text-xs text-slate-600">Current Discount</div>
          <div class="text-2xl font-extrabold text-slate-900" id="totalDiscount">{{ app.total_discount_pct }}%</div>
        </div>
        <a class="btn btn-secondary text-sm hover-scale" href="{{ url_for('client.leaderboard') }}">ğŸ† Leaderboard</a>
        <a class="btn btn-secondary text-sm hover-scale" href="{{ url_for('client.application', app_id=app.id) }}">â† Back</a>
      </div>
    </div>

    <!-- Floating discount popup -->
    <div id="discountPopup" class="discount-popup card rounded-2xl px-6 py-4 bg-gradient-to-r from-emerald-50 to-green-50 border border-emerald-200">
      <div class="text-sm text-emerald-600">Discount Earned!</div>
      <div class="text-3xl font-bold text-gradient" id="popupAmount">+0%</div>
    </div>

    {% if personal_bests and personal_bests|length > 0 %}
      <div class="card rounded-3xl p-4 md:p-5 mb-6 bg-white/90 border border-slate-200">
        <div class="flex items-center justify-between gap-3">
          <div class="text-sm font-bold text-slate-800">Your Top Scores</div>
          <a class="text-sm font-semibold text-primary hover:underline" href="{{ url_for('client.profile') }}">View badges â†’</a>
        </div>
        <div class="mt-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
          {% for s in personal_bests %}
            <div class="rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3">
              <div class="text-xs text-slate-500">{{ s.game_key }}</div>
              <div class="text-lg font-extrabold text-slate-900">{{ s.best_score }}</div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    <!-- Category Tabs -->
    <div class="flex gap-2 mb-6 overflow-x-auto pb-2 fade-in stagger-1" id="categoryTabs">
      <button class="category-pill active" onclick="filterGames('all', this)">ğŸ® All Games <span class="text-xs opacity-60">(41)</span></button>
      <button class="category-pill" onclick="filterGames('skill', this)">âš¡ Skill <span class="text-xs opacity-60">(7)</span></button>
      <button class="category-pill" onclick="filterGames('brain', this)">ğŸ§  Brain <span class="text-xs opacity-60">(6)</span></button>
      <button class="category-pill" onclick="filterGames('luck', this)">ğŸ€ Luck <span class="text-xs opacity-60">(6)</span></button>
      <button class="category-pill" onclick="filterGames('fun', this)">ğŸ˜‚ Fun & Spicy <span class="text-xs opacity-60">(6)</span></button>
      <button class="category-pill" onclick="filterGames('vulgar', this)">ğŸ” Adults Only <span class="text-xs opacity-60">(16)</span></button>
    </div>

    <!-- No Results Message -->
    <div id="noResults" class="hidden text-center py-12 fade-in">
      <div class="text-6xl mb-4">ğŸ”</div>
      <h3 class="text-xl font-bold text-slate-800 mb-2">No games found</h3>
      <p class="text-slate-500">Try a different search or filter</p>
    </div>

    <!-- Games Grid -->
    <div id="gamesGrid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 fade-in stagger-2">
      <!-- SKILL GAMES -->
      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('clickRush')">
        <div class="game-icon bg-gradient-to-br from-violet-500 to-fuchsia-500 mx-auto">âš¡</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Click Rush</h3>
        <p class="text-xs text-slate-400 mt-1">Click fast!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('reaction')">
        <div class="game-icon bg-gradient-to-br from-emerald-500 to-teal-500 mx-auto">ğŸ¯</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Reaction</h3>
        <p class="text-xs text-slate-400 mt-1">Test reflexes</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('keymaster')">
        <div class="game-icon bg-gradient-to-br from-cyan-500 to-sky-500 mx-auto">âŒ¨ï¸</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Keymaster</h3>
        <p class="text-xs text-slate-400 mt-1">Type letters</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('timingTap')">
        <div class="game-icon bg-gradient-to-br from-orange-500 to-red-500 mx-auto">â±ï¸</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Timing Tap</h3>
        <p class="text-xs text-slate-400 mt-1">Hit the zone</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('catchFalling')">
        <div class="game-icon bg-gradient-to-br from-teal-500 to-emerald-500 mx-auto">â­</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Star Catch</h3>
        <p class="text-xs text-slate-400 mt-1">Catch stars</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('drunkWalk')">
        <div class="game-icon bg-gradient-to-br from-amber-500 to-yellow-500 mx-auto">ğŸ¥´</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Drunk Walk</h3>
        <p class="text-xs text-slate-400 mt-1">Stay on path!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="skill" onclick="openGame('speedTyper')">
        <div class="game-icon bg-gradient-to-br from-pink-500 to-rose-500 mx-auto">ğŸ’¬</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Speed Typer</h3>
        <p class="text-xs text-slate-400 mt-1">Type fast!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <!-- BRAIN GAMES -->
      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('memory')">
        <div class="game-icon bg-gradient-to-br from-pink-500 to-rose-500 mx-auto">ğŸ§ </div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Memory</h3>
        <p class="text-xs text-slate-400 mt-1">Match cards</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('quiz')">
        <div class="game-icon bg-gradient-to-br from-blue-500 to-indigo-500 mx-auto">ğŸ“š</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Quiz</h3>
        <p class="text-xs text-slate-400 mt-1">Answer 5 Q</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('mathSprint')">
        <div class="game-icon bg-gradient-to-br from-lime-500 to-green-500 mx-auto">ğŸ”¢</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Math Sprint</h3>
        <p class="text-xs text-slate-400 mt-1">Solve fast</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('wordScramble')">
        <div class="game-icon bg-gradient-to-br from-purple-500 to-violet-500 mx-auto">ğŸ”¤</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Word Scramble</h3>
        <p class="text-xs text-slate-400 mt-1">Unscramble</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('colorMatch')">
        <div class="game-icon bg-gradient-to-br from-fuchsia-500 to-purple-500 mx-auto">ğŸ¨</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Color Match</h3>
        <p class="text-xs text-slate-400 mt-1">Pick color</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="brain" onclick="openGame('patternMemory')">
        <div class="game-icon bg-gradient-to-br from-indigo-500 to-blue-500 mx-auto">ğŸ”²</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Pattern</h3>
        <p class="text-xs text-slate-400 mt-1">Remember sequence</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <!-- LUCK GAMES -->
      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('luckyNumber')">
        <div class="game-icon bg-gradient-to-br from-amber-500 to-orange-500 mx-auto">ğŸ²</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Lucky Number</h3>
        <p class="text-xs text-slate-400 mt-1">Roll 1-100</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('coinFlip')">
        <div class="game-icon bg-gradient-to-br from-yellow-500 to-amber-500 mx-auto">ğŸª™</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Coin Flip</h3>
        <p class="text-xs text-slate-400 mt-1">Guess sides</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('slider')">
        <div class="game-icon bg-gradient-to-br from-red-500 to-pink-500 mx-auto">ğŸšï¸</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Slider</h3>
        <p class="text-xs text-slate-400 mt-1">Match target</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('numberGuess')">
        <div class="game-icon bg-gradient-to-br from-rose-500 to-red-500 mx-auto">ğŸ”®</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Guess Number</h3>
        <p class="text-xs text-slate-400 mt-1">1-100 in 7</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('emojiRoulette')">
        <div class="game-icon bg-gradient-to-br from-pink-500 to-red-500 mx-auto">ğŸ°</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Emoji Slots</h3>
        <p class="text-xs text-slate-400 mt-1">Match 3!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="luck" onclick="openGame('flirtyDice')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('flirtyDice',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-red-400 to-pink-500 mx-auto">ğŸ²</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Spicy Dice</h3>
        <p class="text-xs text-slate-400 mt-1">Roll for fun!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <!-- FUN & SPICY GAMES -->
      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('truthOrDare')">
        <div class="game-icon bg-gradient-to-br from-red-500 to-orange-500 mx-auto">ğŸ”¥</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Truth or Dare</h3>
        <p class="text-xs text-slate-400 mt-1">Spicy edition!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('wouldYouRather')">
        <div class="game-icon bg-gradient-to-br from-purple-500 to-pink-500 mx-auto">ğŸ¤”</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Would You Rather</h3>
        <p class="text-xs text-slate-400 mt-1">Hard choices!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('pickupLine')">
        <div class="game-icon bg-gradient-to-br from-rose-500 to-red-400 mx-auto">ğŸ˜˜</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Pickup Lines</h3>
        <p class="text-xs text-slate-400 mt-1">Rate the cringe!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('dadJoke')">
        <div class="game-icon bg-gradient-to-br from-yellow-500 to-green-500 mx-auto">ğŸ¤£</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Dad Jokes</h3>
        <p class="text-xs text-slate-400 mt-1">Laugh or cringe</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('hotTake')">
        <div class="game-icon bg-gradient-to-br from-orange-500 to-red-500 mx-auto">ğŸŒ¶ï¸</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Hot Takes</h3>
        <p class="text-xs text-slate-400 mt-1">Spicy opinions!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card" data-cat="fun" onclick="openGame('memeCaption')">
        <div class="game-icon bg-gradient-to-br from-cyan-500 to-blue-500 mx-auto">ğŸ˜‚</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Meme Match</h3>
        <p class="text-xs text-slate-400 mt-1">Pick the caption</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <!-- ADULTS ONLY GAMES -->
      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('roastMaster')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('roastMaster',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-red-600 to-orange-600 mx-auto">ğŸ”¥</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Roast Master</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Savage roasts</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('nsfwTrivia')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('nsfwTrivia',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-pink-600 to-red-600 mx-auto">ğŸ”</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">NSFW Trivia</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Embarrassing Q</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('awkwardConfess')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('awkwardConfess',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-purple-600 to-pink-600 mx-auto">ğŸ˜³</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Cringe Confessions</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Rate cringe</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('dirtyMind')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('dirtyMind',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-amber-600 to-red-600 mx-auto">ğŸ§ </div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Dirty Mind Test</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Not what you think</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('bootyShake')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('bootyShake',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-fuchsia-600 to-pink-500 mx-auto">ğŸ‘</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Booty Shake</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Shake it!</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('savageComeback')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('savageComeback',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-slate-700 to-slate-900 mx-auto">ğŸ’€</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Savage Comebacks</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Kill shots</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('neverHaveI')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('neverHaveI',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-rose-500 to-red-700 mx-auto">âœ‹</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Never Have I Ever</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Party game</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-200/50" data-cat="vulgar" onclick="openGame('cursedCompliment')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('cursedCompliment',this)">ğŸ¤</button>
        <div class="game-icon bg-gradient-to-br from-lime-500 to-emerald-700 mx-auto">ğŸ¤®</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Cursed Compliments</h3>
        <p class="text-xs text-red-400 mt-1">ğŸ” Backhanded</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <!-- NEW HIGH-GRAPHICS 18+ GAMES -->
      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('stripPong')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('stripPong',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-red-600 to-pink-700 mx-auto">ğŸ“</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Strip Pong</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('naughtySnake')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('naughtySnake',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-green-600 to-emerald-800 mx-auto">ğŸ</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Naughty Snake</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('kissCatcher')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('kissCatcher',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-pink-500 to-rose-700 mx-auto">ğŸ’‹</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Kiss Catcher</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('spankMole')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('spankMole',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-amber-500 to-orange-700 mx-auto">ğŸ‘</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Spank-a-Mole</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-medium">Medium</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('bodyShots')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('bodyShots',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-violet-600 to-purple-800 mx-auto">ğŸ¯</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Body Shots</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('twerkRunner')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('twerkRunner',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-fuchsia-500 to-pink-800 mx-auto">ğŸƒ</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Twerk Runner</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('stripPoker')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('stripPoker',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-yellow-500 to-red-700 mx-auto">ğŸƒ</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Strip Poker Blitz</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-easy">Easy</span></div>
      </div>

      <div class="game-card game-card-premium spotlight-card border-2 border-red-500/40" data-cat="vulgar" onclick="openGame('naughtyBlocks')">
        <button class="fav-btn" onclick="event.stopPropagation();toggleFav('naughtyBlocks',this)">ğŸ¤</button>
        <span class="best-score-badge">HD</span>
        <div class="game-icon bg-gradient-to-br from-cyan-500 to-blue-800 mx-auto">ğŸ§±</div>
        <h3 class="font-bold text-slate-800 mt-3 text-sm">Naughty Blocks</h3>
        <p class="text-xs text-red-500 font-semibold mt-1">ğŸ” Canvas HD</p>
        <div class="flex items-center justify-center gap-1 mt-2"><span class="difficulty-badge difficulty-hard">Hard</span></div>
      </div>
    </div>
    <div id="gameModal" class="game-modal">
      <div class="game-modal-content">
        <button onclick="closeGame()" class="absolute top-4 right-4 btn btn-secondary z-10">âœ• Close</button>
          <div class="w-full max-w-4xl max-h-[calc(100vh-120px)] overflow-y-auto">
            <div class="card rounded-3xl p-6 md:p-8 mb-6 fade-in">
              <div class="flex items-center gap-4">
                <div class="relative">
                  <img
                    id="gameAvatar"
                    src="{{ url_for('static', filename='images/caricatures/genie.png') }}"
                    alt="Game character"
                    class="w-20 h-20 md:w-24 md:h-24 rounded-2xl object-cover caricature caricature-float"
                    onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';"
                  />
                  <div class="hidden w-20 h-20 md:w-24 md:h-24 rounded-2xl bg-gradient-to-br from-primary/20 to-secondary/20 items-center justify-center text-4xl">ğŸ§</div>
                </div>
                <div class="min-w-0">
                  <div class="text-xs uppercase tracking-wide text-slate-400">Molayman Game</div>
                  <h3 id="gameTitle" class="text-2xl md:text-3xl font-extrabold text-slate-800 truncate">Game</h3>
                  <p class="text-slate-500 text-sm mt-1">Play with Molayman to earn extra discount (cap 70%).</p>
                </div>
              </div>
            </div>

            <div id="gameStage" class="w-full px-2"></div>

    
  </div>

  <style>
    .game-icon {
      width: 64px;
      height: 64px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
      box-shadow: 0 8px 24px -8px rgba(0,0,0,0.2);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .game-card:hover .game-icon {
      transform: scale(1.15) rotate(-8deg);
      box-shadow: 0 12px 28px -8px rgba(0,0,0,0.3);
    }
    .game-card {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .game-card:hover {
      transform: translateY(-10px) scale(1.03);
    }
    .game-card.hidden-card { display: none; }
    
    /* Difficulty dots */
    .game-difficulty { display: flex; gap: 4px; justify-content: center; }
    .diff-dot { width: 8px; height: 8px; border-radius: 50%; background: #e2e8f0; }
    .diff-dot.easy { background: linear-gradient(135deg, #6366f1, #ec4899); }

    /* Category tabs */
    .game-tab {
      padding: 8px 18px;
      border-radius: 999px;
      font-size: 14px;
      font-weight: 600;
      white-space: nowrap;
      cursor: pointer;
      border: 2px solid rgba(99,102,241,0.15);
      background: rgba(255,255,255,0.7);
      color: #64748b;
      transition: all 0.3s ease;
    }
    .game-tab:hover { border-color: #6366f1; color: #6366f1; }
    .game-tab.active {
      background: linear-gradient(135deg, #6366f1, #818cf8);
      color: white;
      border-color: transparent;
      box-shadow: 0 4px 16px -4px rgba(99,102,241,0.4);
    }

    /* Game internal styles */
    #gameContainer input, #gameStage input[type="text"], #gameStage input[type="number"] {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid rgba(99, 102, 241, 0.15);
      border-radius: 12px;
      font-size: 16px;
      transition: all 0.2s ease;
    }
    #gameStage input:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }
    #gameStage button {
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }
    .game-btn-primary {
      background: linear-gradient(135deg, #6366f1, #818cf8);
      color: white;
      border: none;
    }
    .game-btn-primary:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 20px -4px rgba(99, 102, 241, 0.4);
    }
    .game-btn-secondary {
      background: white;
      color: #1e293b;
      border: 2px solid rgba(99, 102, 241, 0.2);
    }
    .game-btn-secondary:hover {
      border-color: #6366f1;
      transform: translateY(-2px);
    }
    .game-btn-danger {
      background: linear-gradient(135deg, #ef4444, #f97316);
      color: white;
      border: none;
    }
    .game-btn-danger:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px -4px rgba(239,68,68,0.4);
    }
    .game-btn-fun {
      background: linear-gradient(135deg, #ec4899, #f43f5e);
      color: white;
      border: none;
    }
    .game-btn-fun:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0 8px 20px -4px rgba(236,72,153,0.4);
    }
    @keyframes game-correct {
      0%, 100% { background-color: transparent; }
      50% { background-color: rgba(16, 185, 129, 0.2); }
    }
    @keyframes game-wrong {
      0%, 100% { background-color: transparent; }
      50% { background-color: rgba(239, 68, 68, 0.2); }
    }
    .game-correct { animation: game-correct 0.5s ease; }
    .game-wrong { animation: game-wrong 0.5s ease; }
    @keyframes bounce-in {
      0% { transform: scale(0.3); opacity: 0; }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.9); }
      100% { transform: scale(1); opacity: 1; }
    }
    .bounce-in { animation: bounce-in 0.5s ease; }
    @keyframes wiggle {
      0%, 100% { transform: rotate(0); }
      25% { transform: rotate(-5deg); }
      75% { transform: rotate(5deg); }
    }
    .wiggle { animation: wiggle 0.4s ease; }
    @keyframes pulse-glow {
      0%, 100% { box-shadow: 0 0 0 0 rgba(99,102,241,0.4); }
      50% { box-shadow: 0 0 20px 10px rgba(99,102,241,0.15); }
    }
    .pulse-glow { animation: pulse-glow 2s ease-in-out infinite; }
    @keyframes slot-spin {
      0% { transform: translateY(0); }
      100% { transform: translateY(-100%); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-6px); }
      40%, 80% { transform: translateX(6px); }
    }
    .shake { animation: shake 0.5s ease; }
    @keyframes tada {
      0% { transform: scale(1); }
      10%, 20% { transform: scale(0.9) rotate(-3deg); }
      30%, 50%, 70%, 90% { transform: scale(1.1) rotate(3deg); }
      40%, 60%, 80% { transform: scale(1.1) rotate(-3deg); }
      100% { transform: scale(1) rotate(0); }
    }
    .tada { animation: tada 0.8s ease; }
    /* Drunk walk game */
    .drunk-path { transition: all 0.05s linear; }
    /* Spicy meter */
    .spicy-meter {
      display: flex; gap: 4px;
    }
    .spicy-pepper {
      font-size: 20px;
      filter: grayscale(1);
      transition: filter 0.3s ease;
    }
    .spicy-pepper.active { filter: grayscale(0); }

    /* Enhanced animation effects */
    @keyframes neon-pulse {
      0%, 100% { text-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 20px currentColor; }
      50% { text-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 40px currentColor, 0 0 80px currentColor; }
    }
    .neon-text { animation: neon-pulse 2s ease-in-out infinite; }

    @keyframes rainbow-bg {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .rainbow-bg {
      background: linear-gradient(270deg, #ef4444, #f59e0b, #10b981, #3b82f6, #a855f7, #ec4899);
      background-size: 600% 600%;
      animation: rainbow-bg 4s ease infinite;
    }

    @keyframes float-rotate {
      0%, 100% { transform: translateY(0) rotate(0deg); }
      25% { transform: translateY(-10px) rotate(5deg); }
      50% { transform: translateY(-20px) rotate(0deg); }
      75% { transform: translateY(-10px) rotate(-5deg); }
    }
    .float-rotate { animation: float-rotate 3s ease-in-out infinite; }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      14% { transform: scale(1.3); }
      28% { transform: scale(1); }
      42% { transform: scale(1.3); }
      70% { transform: scale(1); }
    }
    .heartbeat { animation: heartbeat 1.5s ease-in-out infinite; }

    @keyframes glitch {
      0%, 100% { transform: translate(0); }
      20% { transform: translate(-2px, 2px); }
      40% { transform: translate(-2px, -2px); }
      60% { transform: translate(2px, 2px); }
      80% { transform: translate(2px, -2px); }
    }
    .glitch { animation: glitch 0.3s ease infinite; }

    @keyframes explode {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.5); opacity: 0.8; }
      100% { transform: scale(0); opacity: 0; }
    }

    @keyframes level-up-beam {
      0% { transform: scaleY(0); opacity: 0; }
      50% { transform: scaleY(1); opacity: 1; }
      100% { transform: scaleY(0); opacity: 0; }
    }

    .level-up-beam::before {
      content: '';
      position: absolute;
      left: 50%;
      bottom: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(to top, transparent, #fbbf24, #f59e0b);
      transform-origin: bottom;
      animation: level-up-beam 0.8s ease-out;
    }

    /* Adult game card glow */
    .game-card[data-cat="vulgar"] {
      background: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(254,226,226,0.5));
    }
    .game-card[data-cat="vulgar"]:hover {
      box-shadow: 0 0 30px rgba(239,68,68,0.3), 0 25px 50px -12px rgba(239,68,68,0.25);
    }
    .game-card[data-cat="vulgar"] .game-icon {
      box-shadow: 0 0 20px rgba(239,68,68,0.3);
    }

    /* Combo display */
    .combo-display {
      animation: heartbeat 0.8s ease-in-out;
    }

    /* Enhanced score animation */
    @keyframes score-pop {
      0% { transform: scale(0.5) translateY(0); opacity: 0; }
      50% { transform: scale(1.2) translateY(-20px); opacity: 1; }
      100% { transform: scale(1) translateY(-40px); opacity: 0; }
    }
  </style>

  <script>
    const appId = {{ app.id }};
    const csrf = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
    let currentGame = null;
    

    const CARICATURES = {
      genie: "{{ url_for('static', filename='images/caricatures/genie.png') }}",
      games: "{{ url_for('static', filename='images/caricatures/games.png') }}",
      spin: "{{ url_for('static', filename='images/caricatures/spin.png') }}",
      chat: "{{ url_for('static', filename='images/caricatures/chat.png') }}",
      teacher: "{{ url_for('static', filename='images/caricatures/teacher.png') }}",
      money: "{{ url_for('static', filename='images/caricatures/money.png') }}",
      extra1: "{{ url_for('static', filename='images/caricatures/extra1.png') }}",
      extra2: "{{ url_for('static', filename='images/caricatures/extra2.png') }}",
      extra3: "{{ url_for('static', filename='images/caricatures/extra3.png') }}",
      extra4: "{{ url_for('static', filename='images/caricatures/extra4.png') }}",
    };

    const GAME_META = {
      clickRush:     { title: 'Click Rush',       avatar: 'extra1' },
      reaction:      { title: 'Reaction',         avatar: 'extra2' },
      luckyNumber:   { title: 'Lucky Number',     avatar: 'extra3' },
      memory:        { title: 'Memory',           avatar: 'extra4' },
      quiz:          { title: 'Quiz',             avatar: 'teacher' },
      keymaster:     { title: 'Keymaster',        avatar: 'games' },
      mathSprint:    { title: 'Math Sprint',      avatar: 'teacher' },
      coinFlip:      { title: 'Coin Flip',        avatar: 'money' },
      slider:        { title: 'Slider',           avatar: 'games' },
      wordScramble:  { title: 'Word Scramble',    avatar: 'extra2' },
      timingTap:     { title: 'Timing Tap',       avatar: 'spin' },
      colorMatch:    { title: 'Color Match',      avatar: 'extra1' },
      patternMemory: { title: 'Pattern',          avatar: 'extra4' },
      catchFalling:  { title: 'Star Catch',       avatar: 'extra3' },
      numberGuess:   { title: 'Guess Number',     avatar: 'genie' },
      // NEW GAMES
      emojiRoulette: { title: 'Emoji Slots',      avatar: 'money' },
      truthOrDare:   { title: 'Truth or Dare',    avatar: 'genie' },
      wouldYouRather:{ title: 'Would You Rather', avatar: 'extra1' },
      pickupLine:    { title: 'Pickup Lines',     avatar: 'extra2' },
      dadJoke:       { title: 'Dad Jokes',        avatar: 'extra3' },
      hotTake:       { title: 'Hot Takes',        avatar: 'extra4' },
      drunkWalk:     { title: 'Drunk Walk',       avatar: 'genie' },
      speedTyper:    { title: 'Speed Typer',      avatar: 'teacher' },
      flirtyDice:    { title: 'Spicy Dice',       avatar: 'money' },
      memeCaption:   { title: 'Meme Match',       avatar: 'games' },
      // ADULTS ONLY
      roastMaster:   { title: 'Roast Master',     avatar: 'extra1' },
      nsfwTrivia:    { title: 'NSFW Trivia',       avatar: 'extra4' },
      awkwardConfess:{ title: 'Cringe Confessions',avatar: 'extra2' },
      dirtyMind:     { title: 'Dirty Mind Test',   avatar: 'genie' },
      bootyShake:    { title: 'Booty Shake',       avatar: 'extra3' },
      savageComeback:{ title: 'Savage Comebacks',  avatar: 'extra1' },
      neverHaveI:    { title: 'Never Have I Ever', avatar: 'extra4' },
      cursedCompliment:{ title:'Cursed Compliments',avatar:'extra2' },
      // HIGH-GRAPHICS 18+ CANVAS GAMES
      stripPong:     { title: 'Strip Pong',        avatar: 'extra3' },
      naughtySnake:  { title: 'Naughty Snake',     avatar: 'extra1' },
      kissCatcher:   { title: 'Kiss Catcher',      avatar: 'extra4' },
      spankMole:     { title: 'Spank-a-Mole',      avatar: 'extra2' },
      bodyShots:     { title: 'Body Shots',        avatar: 'extra3' },
      twerkRunner:   { title: 'Twerk Runner',      avatar: 'extra1' },
      stripPoker:    { title: 'Strip Poker Blitz', avatar: 'extra4' },
      naughtyBlocks: { title: 'Naughty Blocks',    avatar: 'genie' },
    };

    // Visual effects disabled (engagement is server-side via badges/streak/weekly challenge)
    function launchConfetti() { /* no-op */ }

    // ============ UTILITY ============
    function showDiscountPopup(amount) {
      const popup = document.getElementById('discountPopup');
      const amountEl = document.getElementById('popupAmount');
      amountEl.textContent = '+' + amount + '%';
      popup.classList.add('show');
      setTimeout(() => popup.classList.remove('show'), 3000);
    }

    function postScore(gameKey, score) {
      const form = new FormData();
      form.append('game_key', gameKey);
      form.append('score', String(score));
      return fetch(`/client/application/${appId}/games/submit`, {
        method: 'POST',
        body: form,
        credentials: 'same-origin',
        headers: { 'X-CSRFToken': csrf }
      }).then(() => {
        setTimeout(() => window.location.reload(), 350);
      });
    }

    function filterGames(cat, btn) {
      document.querySelectorAll('.category-pill').forEach(t => t.classList.remove('active'));
      btn.classList.add('active');
      document.querySelectorAll('.game-card').forEach(card => {
        if (cat === 'all' || card.dataset.cat === cat) {
          card.classList.remove('hidden-card');
          card.style.animation = 'bounce-in 0.4s ease forwards';
        } else {
          card.classList.add('hidden-card');
        }
      });
    }

    function openGame(game) {
      currentGame = game;
      document.getElementById('gameModal').classList.add('active');
      document.body.style.overflow = 'hidden';
      renderGame(game);
    }

    function closeGame() {
      document.getElementById('gameModal').classList.remove('active');
      document.body.style.overflow = '';
      document.getElementById('gameStage').innerHTML = '';
      currentGame = null;
    }

    function renderGame(game) {
      const meta = GAME_META[game] || { title: 'Game', avatar: 'genie' };
      const avatarEl = document.getElementById('gameAvatar');
      const titleEl = document.getElementById('gameTitle');
      if (titleEl) titleEl.textContent = meta.title;
      if (avatarEl) avatarEl.src = CARICATURES[meta.avatar] || CARICATURES.genie;

      const container = document.getElementById('gameStage');
      const games = {
        clickRush: renderClickRush,
        reaction: renderReaction,
        luckyNumber: renderLuckyNumber,
        memory: renderMemory,
        quiz: renderQuiz,
        keymaster: renderKeymaster,
        mathSprint: renderMathSprint,
        coinFlip: renderCoinFlip,
        slider: renderSlider,
        wordScramble: renderWordScramble,
        timingTap: renderTimingTap,
        colorMatch: renderColorMatch,
        patternMemory: renderPatternMemory,
        catchFalling: renderCatchFalling,
        numberGuess: renderNumberGuess,
        // NEW
        emojiRoulette: renderEmojiRoulette,
        truthOrDare: renderTruthOrDare,
        wouldYouRather: renderWouldYouRather,
        pickupLine: renderPickupLine,
        dadJoke: renderDadJoke,
        hotTake: renderHotTake,
        drunkWalk: renderDrunkWalk,
        speedTyper: renderSpeedTyper,
        flirtyDice: renderFlirtyDice,
        memeCaption: renderMemeCaption,
        // ADULTS ONLY
        roastMaster: renderRoastMaster,
        nsfwTrivia: renderNsfwTrivia,
        awkwardConfess: renderAwkwardConfess,
        dirtyMind: renderDirtyMind,
        bootyShake: renderBootyShake,
        savageComeback: renderSavageComeback,
        neverHaveI: renderNeverHaveI,
        cursedCompliment: renderCursedCompliment,
        // HIGH-GRAPHICS 18+ CANVAS GAMES
        stripPong: renderStripPong,
        naughtySnake: renderNaughtySnake,
        kissCatcher: renderKissCatcher,
        spankMole: renderSpankMole,
        bodyShots: renderBodyShots,
        twerkRunner: renderTwerkRunner,
        stripPoker: renderStripPoker,
        naughtyBlocks: renderNaughtyBlocks,
      };
      if (games[game]) games[game](container);
    }

    // ==================== ORIGINAL GAME IMPLEMENTATIONS ====================

    function renderClickRush(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">âš¡</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Click Rush</h3>
          <p class="text-slate-500 mb-6">Click as fast as you can for 10 seconds!</p>
          <div class="h-4 rounded-full bg-slate-100 mb-4 overflow-hidden">
            <div id="crProgress" class="h-full bg-gradient-to-r from-violet-500 to-fuchsia-500 transition-all" style="width: 0%"></div>
          </div>
          <div class="flex justify-between text-sm text-slate-500 mb-6">
            <span id="crClicks">Clicks: 0</span>
            <span id="crTimer">10.0s</span>
          </div>
          <button id="crStart" class="game-btn-primary w-full mb-3">ğŸš€ Start</button>
          <button id="crBtn" class="game-btn-fun w-full text-3xl py-6 pulse-glow" disabled>ğŸ‘† CLICK ME!</button>
        </div>
      `;
      let clicks = 0, running = false, timer;
      const startBtn = container.querySelector('#crStart');
      const clickBtn = container.querySelector('#crBtn');
      const progress = container.querySelector('#crProgress');
      const clicksEl = container.querySelector('#crClicks');
      const timerEl = container.querySelector('#crTimer');

      startBtn.onclick = () => {
        clicks = 0; running = true;
        clickBtn.disabled = false; startBtn.disabled = true;
        let timeLeft = 10;
        timer = setInterval(() => {
          timeLeft -= 0.1;
          timerEl.textContent = timeLeft.toFixed(1) + 's';
          if (timeLeft <= 0) {
            clearInterval(timer); running = false; clickBtn.disabled = true;
            postScore('click_rush', clicks);
          }
        }, 100);
      };
      clickBtn.onclick = () => {
        if (!running) return;
        clicks++;
        clicksEl.textContent = 'Clicks: ' + clicks;
        progress.style.width = Math.min(100, (clicks / 280) * 100) + '%';
        clickBtn.classList.add('tada');
        setTimeout(() => clickBtn.classList.remove('tada'), 300);
      };
    }

    function renderReaction(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ¯</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Reaction</h3>
          <p class="text-slate-500 mb-6">Click when the box turns green!</p>
          <div id="reactionBox" class="h-48 rounded-2xl flex items-center justify-center text-xl font-bold cursor-pointer transition-all" style="background: #e2e8f0;">
            Click to start
          </div>
          <p id="reactionStat" class="text-slate-500 mt-4"></p>
        </div>
      `;
      const box = container.querySelector('#reactionBox');
      const stat = container.querySelector('#reactionStat');
      let waiting = false, startTime;

      box.onclick = () => {
        if (box.style.background === 'rgb(34, 197, 94)') {
          const time = Date.now() - startTime;
          stat.textContent = 'Reaction: ' + time + 'ms';
          box.style.background = '#e2e8f0'; box.textContent = 'Click to play again';
          if (time < 300) postScore('reaction', time);
        } else if (waiting) {
          stat.textContent = 'Too early! Click to try again.';
          box.style.background = '#ef4444'; box.textContent = 'âŒ Too early!'; waiting = false;
        } else {
          waiting = true; box.style.background = '#fbbf24'; box.textContent = 'Wait for green...';
          setTimeout(() => { if (waiting) { box.style.background = '#22c55e'; box.textContent = 'CLICK NOW!'; startTime = Date.now(); } }, 1000 + Math.random() * 3000);
        }
      };
    }

    function renderLuckyNumber(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ²</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Lucky Number</h3>
          <p class="text-slate-500 mb-6">Roll 1-100. Higher is better!</p>
          <div id="lnDisplay" class="text-8xl font-bold text-gradient py-8">?</div>
          <button id="lnRoll" class="game-btn-primary w-full">ğŸ² Roll!</button>
          <p id="lnStat" class="text-slate-500 mt-4">Try your luck!</p>
        </div>
      `;
      const display = container.querySelector('#lnDisplay');
      const rollBtn = container.querySelector('#lnRoll');
      const stat = container.querySelector('#lnStat');

      rollBtn.onclick = () => {
        rollBtn.disabled = true; let count = 0;
        const interval = setInterval(() => {
          display.textContent = Math.floor(Math.random() * 100) + 1;
          display.classList.add('wiggle'); setTimeout(() => display.classList.remove('wiggle'), 200);
          count++;
          if (count > 20) {
            clearInterval(interval);
            const final = Math.floor(Math.random() * 100) + 1;
            display.textContent = final;
            stat.textContent = final >= 80 ? 'ğŸ‰ Fantastic!' : final >= 50 ? 'ğŸ‘ Nice!' : 'ğŸ˜… Try again!';
            postScore('lucky_number', final);
          }
        }, 80);
      };
    }

    function renderMemory(container) {
      const emojis = ['ğŸ®','ğŸ²','ğŸ¯','ğŸ¨','ğŸ­','ğŸª','ğŸ¢','ğŸ¡'];
      const cards = [...emojis,...emojis].sort(() => Math.random() - 0.5);
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ§ </div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Memory</h3>
          <p id="memStat" class="text-slate-500 mb-6">Match all 8 pairs!</p>
          <div id="memGrid" class="grid grid-cols-4 gap-3"></div>
        </div>
      `;
      const grid = container.querySelector('#memGrid');
      const stat = container.querySelector('#memStat');
      let flipped = [], matches = 0, canClick = true;

      cards.forEach((emoji, i) => {
        const card = document.createElement('div');
        card.className = 'h-16 rounded-xl bg-gradient-to-br from-pink-500 to-rose-500 flex items-center justify-center text-2xl cursor-pointer transition-all hover:scale-105';
        card.textContent = '?'; card.dataset.index = i;
        card.onclick = () => flipCard(card, emoji);
        grid.appendChild(card);
      });

      function flipCard(card, emoji) {
        if (!canClick || card.dataset.flipped) return;
        card.textContent = emoji; card.dataset.flipped = 'true';
        card.style.background = 'white'; card.style.border = '2px solid #ec4899';
        flipped.push({ card, emoji });
        if (flipped.length === 2) {
          canClick = false;
          if (flipped[0].emoji === flipped[1].emoji) {
            matches++; stat.textContent = `Matches: ${matches}/8`;
            flipped = []; canClick = true;
            if (matches === 8) postScore('memory', 100);
          } else {
            setTimeout(() => {
              flipped.forEach(f => { f.card.textContent = '?'; f.card.style.background = 'linear-gradient(135deg, #ec4899, #f43f5e)'; f.card.style.border = 'none'; delete f.card.dataset.flipped; });
              flipped = []; canClick = true;
            }, 1000);
          }
        }
      }
    }

    function renderQuiz(container) {
      const questions = [
        { q: 'Capital of Bangladesh?', a: 'dhaka' },
        { q: '5 Ã— 8 = ?', a: '40' },
        { q: 'Largest planet?', a: 'jupiter' },
        { q: 'H2O is?', a: 'water' },
        { q: 'Square root of 81?', a: '9' }
      ];
      let current = 0, correct = 0;
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ“š</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Quiz</h3>
          <p id="quizQ" class="text-lg text-slate-600 mb-6">${questions[0].q}</p>
          <input id="quizA" class="mb-4" placeholder="Your answer" />
          <button id="quizSubmit" class="game-btn-primary w-full">Submit Answer</button>
          <p id="quizStat" class="text-slate-500 mt-4">Question 1/5</p>
        </div>
      `;
      const qEl = container.querySelector('#quizQ');
      const aEl = container.querySelector('#quizA');
      const submit = container.querySelector('#quizSubmit');
      const stat = container.querySelector('#quizStat');

      submit.onclick = () => {
        if (aEl.value.toLowerCase().trim() === questions[current].a) {
          correct++; container.querySelector('.card').classList.add('game-correct');
        } else { container.querySelector('.card').classList.add('game-wrong'); }
        setTimeout(() => container.querySelector('.card').classList.remove('game-correct', 'game-wrong'), 500);
        current++;
        if (current < questions.length) {
          qEl.textContent = questions[current].q; aEl.value = '';
          stat.textContent = `Question ${current+1}/5 â€¢ Correct: ${correct}`;
        } else {
          stat.textContent = `Final: ${correct}/5 correct!`;
          submit.disabled = true; postScore('quiz', correct * 20);
        }
      };
    }

    function renderKeymaster(container) {
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">âŒ¨ï¸</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Keymaster</h3>
          <p class="text-slate-500 mb-6">Type the letters as fast as you can!</p>
          <div id="keyTarget" class="text-8xl font-bold text-gradient py-8">â€”</div>
          <button id="keyStart" class="game-btn-primary w-full mb-4">Start (20s)</button>
          <div class="flex justify-between text-sm text-slate-500"><span id="keyTimer">20s</span><span id="keyStat">Score: 0</span></div>
        </div>
      `;
      let score = 0, target, running = false;
      const targetEl = container.querySelector('#keyTarget');
      const startBtn = container.querySelector('#keyStart');
      const timerEl = container.querySelector('#keyTimer');
      const statEl = container.querySelector('#keyStat');

      function newTarget() { target = letters[Math.floor(Math.random()*letters.length)]; targetEl.textContent = target; }

      startBtn.onclick = () => {
        score = 0; running = true; newTarget(); startBtn.disabled = true;
        let timeLeft = 20;
        const timer = setInterval(() => { timeLeft -= 0.1; timerEl.textContent = timeLeft.toFixed(1) + 's'; if (timeLeft <= 0) { clearInterval(timer); running = false; targetEl.textContent = 'âœ“'; postScore('keymaster', score); } }, 100);
      };

      document.addEventListener('keydown', (e) => { if (running && e.key.toUpperCase() === target) { score++; statEl.textContent = 'Score: ' + score; targetEl.classList.add('tada'); setTimeout(() => targetEl.classList.remove('tada'), 400); newTarget(); } });
    }

    function renderMathSprint(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ”¢</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Math Sprint</h3>
          <p class="text-slate-500 mb-6">Solve math problems in 15 seconds!</p>
          <div id="mathQ" class="text-4xl font-bold text-slate-800 py-4">? + ? = ?</div>
          <div class="flex gap-2 mt-4"><input id="mathA" type="number" class="flex-1 text-center text-xl" placeholder="=" /><button id="mathSubmit" class="game-btn-primary">âœ“</button></div>
          <button id="mathStart" class="game-btn-secondary w-full mt-4">Start</button>
          <p id="mathStat" class="text-slate-500 mt-4"></p>
        </div>
      `;
      let a, b, op, answer, solved = 0;
      const qEl = container.querySelector('#mathQ');
      const aEl = container.querySelector('#mathA');
      const submit = container.querySelector('#mathSubmit');
      const startBtn = container.querySelector('#mathStart');
      const stat = container.querySelector('#mathStat');

      function newProblem() {
        a = Math.floor(Math.random()*20)+1; b = Math.floor(Math.random()*20)+1;
        op = ['+','-','Ã—'][Math.floor(Math.random()*3)];
        if (op==='+') answer = a+b; else if (op==='-') { if(a<b) [a,b]=[b,a]; answer=a-b; } else answer=a*b;
        qEl.textContent = `${a} ${op} ${b} = ?`; aEl.value = ''; aEl.focus();
      }

      startBtn.onclick = () => { solved = 0; newProblem(); startBtn.disabled = true; let timeLeft = 15;
        const timer = setInterval(() => { timeLeft--; stat.textContent = `Time: ${timeLeft}s â€¢ Solved: ${solved}`; if(timeLeft<=0){clearInterval(timer);postScore('math_sprint',solved*10);} }, 1000);
      };
      submit.onclick = () => { if(parseInt(aEl.value)===answer){solved++;container.querySelector('.card').classList.add('game-correct');setTimeout(()=>container.querySelector('.card').classList.remove('game-correct'),300);newProblem();}else{container.querySelector('.card').classList.add('game-wrong');setTimeout(()=>container.querySelector('.card').classList.remove('game-wrong'),300);} };
    }

    function renderCoinFlip(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸª™</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Coin Flip</h3>
          <p class="text-slate-500 mb-6">Guess heads or tails (10 rounds)</p>
          <div id="coinDisplay" class="text-8xl py-6">ğŸª™</div>
          <div class="flex gap-4 mt-4"><button id="coinHeads" class="game-btn-primary flex-1">ğŸ‘‘ Heads</button><button id="coinTails" class="game-btn-secondary flex-1">ğŸ¦… Tails</button></div>
          <p id="coinStat" class="text-slate-500 mt-4">Round 1/10 â€¢ Score: 0</p>
        </div>
      `;
      let round = 0, score = 0;
      const display = container.querySelector('#coinDisplay');
      const headsBtn = container.querySelector('#coinHeads');
      const tailsBtn = container.querySelector('#coinTails');
      const stat = container.querySelector('#coinStat');

      function flip(guess) {
        if (round >= 10) return;
        const result = Math.random() < 0.5 ? 'heads' : 'tails';
        display.textContent = result === 'heads' ? 'ğŸ‘‘' : 'ğŸ¦…';
        display.classList.add('tada'); setTimeout(() => display.classList.remove('tada'), 600);
        if (guess === result) score++;
        round++;
        stat.textContent = `Round ${Math.min(round+1,10)}/10 â€¢ Score: ${score}`;
        if (round >= 10) { headsBtn.disabled = true; tailsBtn.disabled = true; postScore('coin_flip', score*10); }
      }
      headsBtn.onclick = () => flip('heads');
      tailsBtn.onclick = () => flip('tails');
    }

    function renderSlider(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸšï¸</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Slider</h3>
          <p class="text-slate-500 mb-6">Match the target number!</p>
          <div class="flex justify-between text-lg mb-4"><span class="text-slate-500">Target: <span id="sliderTarget" class="font-bold text-gradient">â€”</span></span><span class="text-slate-500">Your: <span id="sliderValue" class="font-bold">50</span></span></div>
          <input id="sliderInput" type="range" min="1" max="100" value="50" class="w-full mb-4" />
          <button id="sliderNew" class="game-btn-secondary w-full mb-2">New Target</button>
          <button id="sliderLock" class="game-btn-primary w-full">Lock In</button>
          <p id="sliderStat" class="text-slate-500 mt-4"></p>
        </div>
      `;
      let target;
      const targetEl = container.querySelector('#sliderTarget');
      const valueEl = container.querySelector('#sliderValue');
      const input = container.querySelector('#sliderInput');
      const newBtn = container.querySelector('#sliderNew');
      const lockBtn = container.querySelector('#sliderLock');
      const stat = container.querySelector('#sliderStat');

      function newTarget() { target = Math.floor(Math.random()*100)+1; targetEl.textContent = target; stat.textContent = ''; }
      input.oninput = () => valueEl.textContent = input.value;
      newBtn.onclick = newTarget;
      lockBtn.onclick = () => {
        const diff = Math.abs(parseInt(input.value) - target);
        const score = Math.max(0, 100 - diff * 2);
        stat.textContent = `Off by ${diff}. Score: ${score}`;
        if (diff <= 5) postScore('slider', score);
      };
      newTarget();
    }

    function renderWordScramble(container) {
      const words = ['MOLAYMAN','LOTTERY','DISCOUNT','ADMISSION','COLLEGE'];
      let current = 0, correct = 0;
      function scramble(word) { return word.split('').sort(() => Math.random() - 0.5).join(''); }
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ”¤</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Word Scramble</h3>
          <p class="text-slate-500 mb-6">Unscramble 5 words!</p>
          <div id="scrWord" class="text-4xl font-bold text-gradient py-4 tracking-widest">${scramble(words[0])}</div>
          <div class="flex gap-2 mt-4"><input id="scrA" class="flex-1 uppercase tracking-widest text-center" placeholder="ANSWER" /><button id="scrSubmit" class="game-btn-primary">âœ“</button></div>
          <p id="scrStat" class="text-slate-500 mt-4">Word 1/5</p>
        </div>
      `;
      const wordEl = container.querySelector('#scrWord');
      const aEl = container.querySelector('#scrA');
      const submit = container.querySelector('#scrSubmit');
      const stat = container.querySelector('#scrStat');

      submit.onclick = () => {
        if (aEl.value.toUpperCase() === words[current]) { correct++; container.querySelector('.card').classList.add('game-correct'); }
        else { container.querySelector('.card').classList.add('game-wrong'); }
        setTimeout(() => container.querySelector('.card').classList.remove('game-correct', 'game-wrong'), 500);
        current++;
        if (current < words.length) { wordEl.textContent = scramble(words[current]); aEl.value = ''; stat.textContent = `Word ${current+1}/5 â€¢ Correct: ${correct}`; }
        else { stat.textContent = `Final: ${correct}/5 correct!`; submit.disabled = true; postScore('word_scramble', correct * 20); }
      };
    }

    function renderTimingTap(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">â±ï¸</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Timing Tap</h3>
          <p class="text-slate-500 mb-6">Tap when the bar reaches the green zone!</p>
          <div class="h-8 rounded-full bg-slate-100 overflow-hidden relative mb-4">
            <div id="tapBar" class="h-full bg-gradient-to-r from-orange-500 to-red-500" style="width: 0%"></div>
            <div class="absolute right-0 top-0 bottom-0 w-[15%] bg-emerald-500/30 border-l-2 border-emerald-500"></div>
          </div>
          <button id="tapStart" class="game-btn-secondary w-full mb-2">Start</button>
          <button id="tapBtn" class="game-btn-primary w-full text-xl py-4" disabled>TAP!</button>
          <p id="tapStat" class="text-slate-500 mt-4">Hit 10 times in the green zone</p>
        </div>
      `;
      let running = false, round = 0, score = 0, width = 0, dir = 1;
      const bar = container.querySelector('#tapBar');
      const startBtn = container.querySelector('#tapStart');
      const tapBtn = container.querySelector('#tapBtn');
      const stat = container.querySelector('#tapStat');

      function animate() { if(!running)return; width += dir * 0.8; if(width>=100||width<=0) dir*=-1; bar.style.width=width+'%'; requestAnimationFrame(animate); }

      startBtn.onclick = () => { running=true;round=0;score=0;tapBtn.disabled=false;startBtn.disabled=true;animate(); };
      tapBtn.onclick = () => {
        if(!running)return;
        if(width>=85){score++;container.querySelector('.card').classList.add('game-correct');}
        else{container.querySelector('.card').classList.add('game-wrong');}
        setTimeout(()=>container.querySelector('.card').classList.remove('game-correct','game-wrong'),200);
        round++;stat.textContent=`Round ${round}/10 â€¢ Hits: ${score}`;
        if(round>=10){running=false;tapBtn.disabled=true;postScore('timing_tap',score*10);}
      };
    }

    function renderColorMatch(container) {
      const colors = ['red','green','blue','purple'];
      const colorStyles = {red:'#ef4444',green:'#22c55e',blue:'#3b82f6',purple:'#a855f7'};
      let round = 0, score = 0, correctColor;

      function newRound() {
        const word = colors[Math.floor(Math.random()*colors.length)];
        correctColor = colors[Math.floor(Math.random()*colors.length)];
        container.querySelector('#colorWord').textContent = word.toUpperCase();
        container.querySelector('#colorWord').style.color = colorStyles[correctColor];
      }

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ¨</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Color Match</h3>
          <p class="text-slate-500 mb-6">Pick the COLOR of the text, not the word!</p>
          <div id="colorWord" class="text-5xl font-black py-6">â€”</div>
          <div class="grid grid-cols-2 gap-3 mt-4">
            <button class="color-btn game-btn-secondary" data-color="red" style="border-color:#ef4444;color:#ef4444;">Red</button>
            <button class="color-btn game-btn-secondary" data-color="green" style="border-color:#22c55e;color:#22c55e;">Green</button>
            <button class="color-btn game-btn-secondary" data-color="blue" style="border-color:#3b82f6;color:#3b82f6;">Blue</button>
            <button class="color-btn game-btn-secondary" data-color="purple" style="border-color:#a855f7;color:#a855f7;">Purple</button>
          </div>
          <p id="colorStat" class="text-slate-500 mt-4">Round 1/10</p>
        </div>
      `;
      const stat = container.querySelector('#colorStat');
      container.querySelectorAll('.color-btn').forEach(btn => {
        btn.onclick = () => {
          if(round>=10)return;
          if(btn.dataset.color===correctColor){score++;container.querySelector('.card').classList.add('game-correct');}
          else{container.querySelector('.card').classList.add('game-wrong');}
          setTimeout(()=>container.querySelector('.card').classList.remove('game-correct','game-wrong'),300);
          round++;stat.textContent=`Round ${Math.min(round+1,10)}/10 â€¢ Score: ${score}`;
          if(round>=10){postScore('color_match',score*10);}else{newRound();}
        };
      });
      newRound();
    }

    function renderPatternMemory(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ”²</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Pattern</h3>
          <p class="text-slate-500 mb-6">Remember and repeat the sequence!</p>
          <div id="patternGrid" class="grid grid-cols-2 gap-3 max-w-[200px] mx-auto"></div>
          <button id="patternStart" class="game-btn-primary w-full mt-6">Start</button>
          <p id="patternStat" class="text-slate-500 mt-4">Level: 1</p>
        </div>
      `;
      const colors = ['#ef4444','#22c55e','#3b82f6','#fbbf24'];
      const grid = container.querySelector('#patternGrid');
      const startBtn = container.querySelector('#patternStart');
      const stat = container.querySelector('#patternStat');
      let sequence = [], userSeq = [], level = 1, canClick = false;

      colors.forEach((color, i) => {
        const btn = document.createElement('div');
        btn.className = 'h-20 rounded-xl cursor-pointer transition-all';
        btn.style.background = color; btn.style.opacity = '0.5'; btn.dataset.index = i;
        btn.onclick = () => userClick(i); grid.appendChild(btn);
      });

      function flash(index) { const btn=grid.children[index]; btn.style.opacity='1'; btn.style.transform='scale(1.1)'; setTimeout(()=>{btn.style.opacity='0.5';btn.style.transform='scale(1)';},400); }

      function showSequence() {
        canClick = false; sequence.push(Math.floor(Math.random()*4));
        let i = 0;
        const interval = setInterval(()=>{flash(sequence[i]);i++;if(i>=sequence.length){clearInterval(interval);canClick=true;}},600);
      }

      function userClick(index) {
        if(!canClick)return; flash(index); userSeq.push(index);
        if(userSeq[userSeq.length-1]!==sequence[userSeq.length-1]){stat.textContent='Wrong! Final level: '+level;canClick=false;postScore('pattern_memory',level*10);return;}
        if(userSeq.length===sequence.length){level++;userSeq=[];stat.textContent='Level: '+level;setTimeout(showSequence,1000);}
      }

      startBtn.onclick = () => {sequence=[];userSeq=[];level=1;stat.textContent='Level: 1';startBtn.disabled=true;showSequence();};
    }

    function renderCatchFalling(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">â­</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Star Catch</h3>
          <p class="text-slate-500 mb-6">Click the falling stars! 15 seconds.</p>
          <div id="catchArea" class="relative h-64 rounded-xl bg-gradient-to-b from-indigo-100 to-purple-100 overflow-hidden"></div>
          <button id="catchStart" class="game-btn-primary w-full mt-4">Start</button>
          <p id="catchStat" class="text-slate-500 mt-4">Score: 0</p>
        </div>
      `;
      const area = container.querySelector('#catchArea');
      const startBtn = container.querySelector('#catchStart');
      const stat = container.querySelector('#catchStat');
      let score = 0, running = false;

      function spawnStar() {
        if(!running)return;
        const star = document.createElement('div');
        star.textContent = ['â­','ğŸŒŸ','ğŸ’«','âœ¨'][Math.floor(Math.random()*4)];
        star.className = 'absolute text-3xl cursor-pointer transition-transform hover:scale-150';
        star.style.left = Math.random()*80+'%'; star.style.top = '-40px';
        star.onclick = () => { score++; stat.textContent='Score: '+score; star.style.transform='scale(2)'; star.style.opacity='0'; setTimeout(()=>star.remove(),200); };
        area.appendChild(star);
        let pos = -40;
        const fall = setInterval(()=>{pos+=2;star.style.top=pos+'px';if(pos>area.clientHeight){clearInterval(fall);star.remove();}},50);
        setTimeout(spawnStar, 400 + Math.random()*600);
      }

      startBtn.onclick = () => { score=0;running=true;startBtn.disabled=true; spawnStar(); setTimeout(()=>{running=false;postScore('catch_falling',score);},15000); };
    }

    function renderNumberGuess(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ”®</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Guess Number</h3>
          <p class="text-slate-500 mb-6">Guess the number 1-100 in 7 tries!</p>
          <input id="guessInput" type="number" class="text-center text-xl mb-4" placeholder="Your guess" min="1" max="100" />
          <button id="guessSubmit" class="game-btn-primary w-full">Guess</button>
          <p id="guessStat" class="text-slate-500 mt-4">7 tries remaining</p>
        </div>
      `;
      const target = Math.floor(Math.random()*100)+1;
      let tries = 7;
      const input = container.querySelector('#guessInput');
      const submit = container.querySelector('#guessSubmit');
      const stat = container.querySelector('#guessStat');

      submit.onclick = () => {
        const guess = parseInt(input.value); if(!guess||guess<1||guess>100) return;
        tries--;
        if(guess===target){stat.textContent='ğŸ‰ Correct! The number was '+target;submit.disabled=true;postScore('number_guess',(7-tries)*10+30);}
        else if(tries===0){stat.textContent='ğŸ˜¢ Out of tries! It was '+target;submit.disabled=true;}
        else{stat.textContent=(guess<target?'ğŸ“ˆ Higher!':'ğŸ“‰ Lower!')+` (${tries} tries left)`;}
        input.value = '';
      };
    }

    // ==================== NEW GAME IMPLEMENTATIONS ====================

    function renderEmojiRoulette(container) {
      const emojis = ['ğŸ’','ğŸ‹','ğŸ””','ğŸ’','7ï¸âƒ£','ğŸ€','ğŸ‘‘','ğŸ°'];
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ°</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Emoji Slots</h3>
          <p class="text-slate-500 mb-6">Match 3 to win big! 5 spins.</p>
          <div class="flex justify-center gap-4 mb-6">
            <div class="w-24 h-24 rounded-2xl bg-gradient-to-b from-slate-100 to-slate-200 flex items-center justify-center text-5xl border-2 border-slate-300 overflow-hidden" id="slot1">â“</div>
            <div class="w-24 h-24 rounded-2xl bg-gradient-to-b from-slate-100 to-slate-200 flex items-center justify-center text-5xl border-2 border-slate-300 overflow-hidden" id="slot2">â“</div>
            <div class="w-24 h-24 rounded-2xl bg-gradient-to-b from-slate-100 to-slate-200 flex items-center justify-center text-5xl border-2 border-slate-300 overflow-hidden" id="slot3">â“</div>
          </div>
          <button id="slotSpin" class="game-btn-fun w-full text-xl py-4 pulse-glow">ğŸ° SPIN!</button>
          <p id="slotStat" class="text-slate-500 mt-4">5 spins remaining â€¢ Score: 0</p>
        </div>
      `;
      let spins = 5, totalScore = 0;
      const slots = [container.querySelector('#slot1'), container.querySelector('#slot2'), container.querySelector('#slot3')];
      const spinBtn = container.querySelector('#slotSpin');
      const stat = container.querySelector('#slotStat');

      spinBtn.onclick = () => {
        if(spins <= 0) return;
        spins--;
        spinBtn.disabled = true;
        let ticks = 0;
        const interval = setInterval(() => {
          slots.forEach(s => { s.textContent = emojis[Math.floor(Math.random()*emojis.length)]; s.classList.add('wiggle'); });
          ticks++;
          if (ticks > 15) {
            clearInterval(interval);
            const results = slots.map(s => s.textContent);
            slots.forEach(s => s.classList.remove('wiggle'));
            // Check matches
            if (results[0] === results[1] && results[1] === results[2]) {
              totalScore += 30;
              stat.textContent = `ğŸ‰ JACKPOT! Triple ${results[0]}! Score: ${totalScore}`;
              slots.forEach(s => { s.classList.add('tada'); setTimeout(() => s.classList.remove('tada'), 800); });
              launchConfetti(100);
            } else if (results[0] === results[1] || results[1] === results[2] || results[0] === results[2]) {
              totalScore += 10;
              stat.textContent = `ğŸ‘ Pair matched! Score: ${totalScore}`;
            } else {
              stat.textContent = `ğŸ˜… No match. ${spins} spins left â€¢ Score: ${totalScore}`;
            }
            if (spins <= 0) { postScore('emoji_roulette', totalScore); }
            else { spinBtn.disabled = false; }
          }
        }, 120);
      };
    }

    function renderTruthOrDare(container) {
      const truths = [
        "What's the most embarrassing thing you've Googled? ğŸ”",
        "What's the worst pickup line you've ever used? ğŸ˜…",
        "Have you ever pretended to listen to someone while checking your phone? ğŸ“±",
        "What's the cringiest thing in your search history? ğŸ’€",
        "If your browser history was made public, how fast would you leave the country? âœˆï¸",
        "What's the most useless thing you've spent money on? ğŸ’¸",
        "Have you ever laughed at a joke you didn't understand? ğŸ˜‚",
        "What's the pettiest thing you've done in a relationship? ğŸ¤­",
        "What's the worst excuse you've used to skip class? ğŸ“š",
        "If your crush saw your camera roll right now, would you survive? ğŸ“¸",
      ];
      const dares = [
        "Do your best 'duck face' right now! ğŸ¦†",
        "Talk in a British accent for the next 30 seconds! ğŸ©",
        "Send 'I love you' to the 5th person in your contacts! ğŸ’Œ",
        "Do 10 push-ups right now or admit you can't! ğŸ’ª",
        "Post a selfie with no filter on your status! ğŸ“¸",
        "Call a friend and sing Happy Birthday to them! ğŸ‚",
        "Text your mom 'I'm getting married' and screenshot the reply! ğŸ’",
        "Do your best Molayman impression! ğŸ§",
        "Speak in only emojis for the next 2 minutes! ğŸ˜€ğŸ¤ªğŸ‰",
        "Let someone else send a message from your phone! ğŸ“²",
      ];
      let round = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ”¥</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Truth or Dare</h3>
          <p class="text-slate-500 mb-4">Spicy Edition â€¢ 5 rounds!</p>
          <div class="spicy-meter justify-center mb-4" id="spicyMeter">
            <span class="spicy-pepper">ğŸŒ¶ï¸</span><span class="spicy-pepper">ğŸŒ¶ï¸</span><span class="spicy-pepper">ğŸŒ¶ï¸</span><span class="spicy-pepper">ğŸŒ¶ï¸</span><span class="spicy-pepper">ğŸŒ¶ï¸</span>
          </div>
          <div id="todContent" class="text-lg text-slate-700 py-6 px-4 bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl mb-4 min-h-[100px] flex items-center justify-center">
            Pick Truth or Dare to start!
          </div>
          <div class="flex gap-4 mb-2">
            <button id="todTruth" class="game-btn-primary flex-1 text-lg">ğŸ¤« Truth</button>
            <button id="todDare" class="game-btn-danger flex-1 text-lg">ğŸ˜ˆ Dare</button>
          </div>
          <button id="todDone" class="game-btn-fun w-full mt-2 hidden">âœ… Done! Next round</button>
          <p id="todStat" class="text-slate-500 mt-4">Round 1/5</p>
        </div>
      `;

      const content = container.querySelector('#todContent');
      const truthBtn = container.querySelector('#todTruth');
      const dareBtn = container.querySelector('#todDare');
      const doneBtn = container.querySelector('#todDone');
      const stat = container.querySelector('#todStat');
      const peppers = container.querySelectorAll('.spicy-pepper');

      function showChallenge(type) {
        const list = type === 'truth' ? truths : dares;
        const item = list[Math.floor(Math.random() * list.length)];
        content.textContent = item;
        content.classList.add('bounce-in');
        setTimeout(() => content.classList.remove('bounce-in'), 500);
        truthBtn.classList.add('hidden');
        dareBtn.classList.add('hidden');
        doneBtn.classList.remove('hidden');
        score += (type === 'dare' ? 15 : 10);
        peppers.forEach((p, i) => { if (i <= round) p.classList.add('active'); });
      }

      truthBtn.onclick = () => showChallenge('truth');
      dareBtn.onclick = () => showChallenge('dare');
      doneBtn.onclick = () => {
        round++;
        if (round >= 5) {
          stat.textContent = `All done! Score: ${score}`;
          doneBtn.disabled = true;
          postScore('truth_or_dare', score);
        } else {
          stat.textContent = `Round ${round + 1}/5`;
          truthBtn.classList.remove('hidden');
          dareBtn.classList.remove('hidden');
          doneBtn.classList.add('hidden');
          content.textContent = 'Pick Truth or Dare!';
        }
      };
    }

    function renderWouldYouRather(container) {
      const questions = [
        { a: "Always have to shout everything you say ğŸ“¢", b: "Only be able to whisper ğŸ¤«" },
        { a: "Have Molayman as your teacher forever ğŸ§", b: "Have unlimited discount but never attend class ğŸ“" },
        { a: "Never use social media again ğŸ“µ", b: "Never eat your favorite food again ğŸ•" },
        { a: "Be able to fly but only 2 feet off the ground âœˆï¸", b: "Be invisible but only when nobody's looking ğŸ‘»" },
        { a: "Have a rewind button for your life âª", b: "Have a pause button â¸ï¸" },
        { a: "Know how you'll die ğŸ’€", b: "Know when you'll die â°" },
        { a: "Fight 100 duck-sized horses ğŸ´", b: "Fight 1 horse-sized duck ğŸ¦†" },
        { a: "Always be 10 minutes late â°", b: "Always be 20 minutes early ğŸ•" },
        { a: "Have unlimited money but no friends ğŸ’°", b: "Be broke but have amazing friends ğŸ‘¥" },
        { a: "Read everyone's mind ğŸ§ ", b: "Have everyone read YOUR mind ğŸ˜³" },
      ];
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ¤”</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Would You Rather?</h3>
          <p class="text-slate-500 mb-6">Choose wisely! 5 rounds.</p>
          <div class="space-y-3">
            <button id="wyrA" class="game-btn-primary w-full text-left text-sm py-4 px-6">Option A</button>
            <div class="text-2xl font-black text-gradient">OR</div>
            <button id="wyrB" class="game-btn-danger w-full text-left text-sm py-4 px-6">Option B</button>
          </div>
          <p id="wyrStat" class="text-slate-500 mt-4">Question 1/5</p>
        </div>
      `;

      const btnA = container.querySelector('#wyrA');
      const btnB = container.querySelector('#wyrB');
      const stat = container.querySelector('#wyrStat');

      function showQ() {
        const q = questions[current % questions.length];
        btnA.textContent = 'ğŸ…°ï¸ ' + q.a;
        btnB.textContent = 'ğŸ…±ï¸ ' + q.b;
      }

      function pick() {
        score += 10;
        current++;
        if (current >= 5) {
          stat.textContent = `All done! Score: ${score}`;
          btnA.disabled = true; btnB.disabled = true;
          postScore('would_you_rather', score);
        } else {
          stat.textContent = `Question ${current + 1}/5`;
          showQ();
        }
      }

      btnA.onclick = pick;
      btnB.onclick = pick;
      showQ();
    }

    function renderPickupLine(container) {
      const lines = [
        { line: "Are you a magician? Because whenever I look at you, everyone else disappears. âœ¨", cheesy: 3 },
        { line: "Is your name Google? Because you have everything I've been searching for. ğŸ”", cheesy: 4 },
        { line: "Are you a parking ticket? Because you've got 'fine' written all over you. ğŸ«", cheesy: 5 },
        { line: "Do you have a map? I keep getting lost in your eyes. ğŸ—ºï¸", cheesy: 3 },
        { line: "If you were a vegetable, you'd be a cute-cumber. ğŸ¥’", cheesy: 5 },
        { line: "Is your dad a boxer? Because you're a knockout! ğŸ¥Š", cheesy: 4 },
        { line: "Are you a Wi-Fi signal? Because I'm feeling a connection. ğŸ“¶", cheesy: 3 },
        { line: "I must be a snowflake, because I've fallen for you. â„ï¸", cheesy: 2 },
        { line: "Do you believe in love at first sight, or should I walk by again? ğŸš¶", cheesy: 2 },
        { line: "Are you a campfire? Because you're hot and I want s'more. ğŸ”¥", cheesy: 4 },
      ];
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ˜˜</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Pickup Line Rater</h3>
          <p class="text-slate-500 mb-4">Rate the cringe level! 5 lines.</p>
          <div id="plLine" class="text-lg text-slate-700 py-6 px-4 bg-gradient-to-r from-pink-50 to-rose-50 rounded-2xl mb-4 italic min-h-[100px] flex items-center justify-center"></div>
          <p class="text-sm text-slate-400 mb-3">How cheesy is this? (1-5)</p>
          <div class="flex gap-2 justify-center mb-4">
            <button class="cheese-btn game-btn-secondary px-4" data-val="1">1 ğŸ˜</button>
            <button class="cheese-btn game-btn-secondary px-4" data-val="2">2 ğŸ§€</button>
            <button class="cheese-btn game-btn-secondary px-4" data-val="3">3 ğŸ§€ğŸ§€</button>
            <button class="cheese-btn game-btn-secondary px-4" data-val="4">4 ğŸ¤®</button>
            <button class="cheese-btn game-btn-secondary px-4" data-val="5">5 â˜ ï¸</button>
          </div>
          <p id="plStat" class="text-slate-500 mt-4">Line 1/5</p>
        </div>
      `;

      const lineEl = container.querySelector('#plLine');
      const stat = container.querySelector('#plStat');

      function showLine() { lineEl.textContent = '"' + lines[current].line + '"'; }

      container.querySelectorAll('.cheese-btn').forEach(btn => {
        btn.onclick = () => {
          const val = parseInt(btn.dataset.val);
          const diff = Math.abs(val - lines[current].cheesy);
          if (diff <= 1) { score += 15; container.querySelector('.card').classList.add('game-correct'); }
          else { container.querySelector('.card').classList.add('game-wrong'); }
          setTimeout(() => container.querySelector('.card').classList.remove('game-correct', 'game-wrong'), 400);
          current++;
          if (current >= 5) { stat.textContent = `Done! Score: ${score}`; container.querySelectorAll('.cheese-btn').forEach(b => b.disabled = true); postScore('pickup_line', score); }
          else { stat.textContent = `Line ${current + 1}/5`; showLine(); }
        };
      });
      showLine();
    }

    function renderDadJoke(container) {
      const jokes = [
        { setup: "Why don't scientists trust atoms?", punchline: "Because they make up everything! ğŸ”¬" },
        { setup: "What do you call a fake noodle?", punchline: "An IMPASTA! ğŸ" },
        { setup: "Why did the math book look so sad?", punchline: "Because it had too many problems! ğŸ“–" },
        { setup: "What do you call a bear with no teeth?", punchline: "A gummy bear! ğŸ»" },
        { setup: "Why don't eggs tell jokes?", punchline: "They'd crack each other up! ğŸ¥š" },
        { setup: "What did the ocean say to the beach?", punchline: "Nothing, it just waved! ğŸŒŠ" },
        { setup: "Why did the scarecrow win an award?", punchline: "He was outstanding in his field! ğŸŒ¾" },
        { setup: "What do you call a sleeping dinosaur?", punchline: "A dino-snore! ğŸ¦•" },
        { setup: "Why can't a bicycle stand on its own?", punchline: "Because it's two-tired! ğŸš²" },
        { setup: "What did one wall say to the other?", punchline: "I'll meet you at the corner! ğŸ§±" },
      ];
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ¤£</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Dad Joke Generator</h3>
          <p class="text-slate-500 mb-4">Rate 5 dad jokes!</p>
          <div id="jokeSetup" class="text-xl font-bold text-slate-800 py-4">${jokes[0].setup}</div>
          <div id="jokePunchline" class="text-lg text-gradient py-4 hidden">${jokes[0].punchline}</div>
          <button id="jokeReveal" class="game-btn-primary w-full mb-3">ğŸ˜‚ Tell me!</button>
          <div id="jokeRate" class="flex gap-3 justify-center hidden">
            <button class="joke-rate game-btn-fun flex-1" data-val="laugh">ğŸ¤£ LOL</button>
            <button class="joke-rate game-btn-secondary flex-1" data-val="meh">ğŸ˜ Meh</button>
            <button class="joke-rate game-btn-danger flex-1" data-val="groan">ğŸ˜© Groan</button>
          </div>
          <p id="jokeStat" class="text-slate-500 mt-4">Joke 1/5</p>
        </div>
      `;

      const setupEl = container.querySelector('#jokeSetup');
      const punchEl = container.querySelector('#jokePunchline');
      const revealBtn = container.querySelector('#jokeReveal');
      const rateDiv = container.querySelector('#jokeRate');
      const stat = container.querySelector('#jokeStat');

      revealBtn.onclick = () => {
        punchEl.textContent = jokes[current].punchline;
        punchEl.classList.remove('hidden');
        punchEl.classList.add('bounce-in');
        revealBtn.classList.add('hidden');
        rateDiv.classList.remove('hidden');
      };

      container.querySelectorAll('.joke-rate').forEach(btn => {
        btn.onclick = () => {
          score += (btn.dataset.val === 'laugh' ? 15 : btn.dataset.val === 'groan' ? 10 : 5);
          current++;
          if (current >= 5) { stat.textContent = `All rated! Score: ${score}`; rateDiv.classList.add('hidden'); postScore('dad_joke', score); }
          else {
            setupEl.textContent = jokes[current].setup;
            punchEl.classList.add('hidden');
            revealBtn.classList.remove('hidden');
            rateDiv.classList.add('hidden');
            stat.textContent = `Joke ${current + 1}/5`;
          }
        };
      });
    }

    function renderHotTake(container) {
      const takes = [
        "Pineapple on pizza is actually delicious ğŸ•",
        "Cold showers are better than hot showers ğŸš¿",
        "Monday is the best day of the week ğŸ“…",
        "Homework actually helps you learn ğŸ“",
        "Sleeping with socks on is comfortable ğŸ§¦",
        "Math is more fun than art ğŸ”¢",
        "Tea is superior to coffee â˜•",
        "Rain is better weather than sunshine ğŸŒ§ï¸",
        "The book is NOT always better than the movie ğŸ“–",
        "Waking up early is better than staying up late ğŸŒ…",
        "Social media has done more good than harm ğŸ“±",
        "Cats are better than dogs ğŸ±",
      ];
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸŒ¶ï¸</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Hot Takes</h3>
          <p class="text-slate-500 mb-4">Rate the spiciness! 7 takes.</p>
          <div id="hotTakeText" class="text-xl font-bold text-slate-700 py-6 px-4 bg-gradient-to-r from-orange-50 to-red-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center"></div>
          <div class="flex gap-3">
            <button id="htAgree" class="game-btn-fun flex-1 text-lg">ğŸ”¥ Agree</button>
            <button id="htDisagree" class="game-btn-secondary flex-1 text-lg">â„ï¸ Disagree</button>
            <button id="htNuclear" class="game-btn-danger flex-1 text-lg">â˜¢ï¸ NUCLEAR</button>
          </div>
          <p id="htStat" class="text-slate-500 mt-4">Take 1/7 â€¢ Score: 0</p>
        </div>
      `;

      const takeEl = container.querySelector('#hotTakeText');
      const agreeBtn = container.querySelector('#htAgree');
      const disagreeBtn = container.querySelector('#htDisagree');
      const nuclearBtn = container.querySelector('#htNuclear');
      const stat = container.querySelector('#htStat');

      function showTake() { takeEl.textContent = takes[current]; takeEl.classList.add('bounce-in'); setTimeout(() => takeEl.classList.remove('bounce-in'), 500); }

      function rate(points) {
        score += points; current++;
        if (current >= 7) { stat.textContent = `All rated! Final score: ${score}`; [agreeBtn, disagreeBtn, nuclearBtn].forEach(b => b.disabled = true); postScore('hot_take', score); }
        else { stat.textContent = `Take ${current + 1}/7 â€¢ Score: ${score}`; showTake(); }
      }

      agreeBtn.onclick = () => rate(8);
      disagreeBtn.onclick = () => rate(8);
      nuclearBtn.onclick = () => { rate(15); launchConfetti(30); };
      showTake();
    }

    function renderDrunkWalk(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ¥´</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Molayman Drunk Walk</h3>
          <p class="text-slate-500 mb-4">Keep the wobbling character on the path! Use â† â†’ arrow keys or buttons.</p>
          <canvas id="drunkCanvas" width="400" height="300" class="rounded-xl mx-auto border-2 border-slate-200 bg-gradient-to-b from-green-50 to-emerald-100" style="max-width:100%;"></canvas>
          <div class="flex gap-4 mt-4 justify-center">
            <button id="dwLeft" class="game-btn-primary text-2xl px-6">â¬…ï¸</button>
            <button id="dwStart" class="game-btn-fun px-8">ğŸš€ Start</button>
            <button id="dwRight" class="game-btn-primary text-2xl px-6">â¡ï¸</button>
          </div>
          <p id="dwStat" class="text-slate-500 mt-4">Stay on the road!</p>
        </div>
      `;
      const canvas = container.querySelector('#drunkCanvas');
      const ctx = canvas.getContext('2d');
      const startBtn = container.querySelector('#dwStart');
      const stat = container.querySelector('#dwStat');
      let playerX = 200, roadOffset = 0, score = 0, running = false, wobble = 0, roadWidth = 120;

      function draw() {
        if (!running) return;
        ctx.clearRect(0, 0, 400, 300);
        // Road
        const roadCenter = 200 + Math.sin(roadOffset * 0.02) * 80;
        ctx.fillStyle = '#94a3b8';
        ctx.fillRect(roadCenter - roadWidth/2, 0, roadWidth, 300);
        ctx.setLineDash([10, 10]);
        ctx.strokeStyle = '#fbbf24';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(roadCenter, 0);
        ctx.lineTo(roadCenter, 300);
        ctx.stroke();
        ctx.setLineDash([]);
        // Wobble
        wobble += (Math.random() - 0.5) * 1.5;
        playerX += wobble * 0.2;
        // Player
        ctx.font = '30px serif';
        ctx.fillText('ğŸ¥´', playerX - 15, 270);
        // Check collision
        if (playerX < roadCenter - roadWidth/2 || playerX > roadCenter + roadWidth/2) {
          running = false;
          stat.textContent = `Fell off! Distance: ${score}m`;
          postScore('drunk_walk', score);
          return;
        }
        score++;
        roadOffset++;
        if (score % 100 === 0 && roadWidth > 60) roadWidth -= 5;
        stat.textContent = `Distance: ${score}m | Road narrows...`;
        requestAnimationFrame(draw);
      }

      startBtn.onclick = () => { playerX=200; roadOffset=0; score=0; running=true; wobble=0; roadWidth=120; startBtn.disabled=true; draw(); };
      container.querySelector('#dwLeft').onmousedown = () => { wobble -= 4; };
      container.querySelector('#dwRight').onmousedown = () => { wobble += 4; };
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowLeft') wobble -= 4;
        if (e.key === 'ArrowRight') wobble += 4;
      });
    }

    function renderSpeedTyper(container) {
      const phrases = [
        "Molayman is the best teacher ever!",
        "I love getting discounts on tuition",
        "This game is absolutely hilarious",
        "Why did the chicken cross the road",
        "I promise to study harder this year",
        "The quick brown fox jumps high",
        "Monday morning blues are real",
        "Pizza is the answer to everything",
        "I should be studying right now",
        "Procrastination is my superpower",
      ];
      let current = 0, score = 0, startTime;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ’¬</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Speed Typer</h3>
          <p class="text-slate-500 mb-4">Type the phrase as fast as you can! 5 phrases.</p>
          <div id="stPhrase" class="text-xl font-bold text-slate-800 py-4 px-4 bg-gradient-to-r from-pink-50 to-purple-50 rounded-2xl mb-4"></div>
          <input id="stInput" type="text" class="mb-4 text-center" placeholder="Type here..." autocomplete="off" />
          <div class="h-3 rounded-full bg-slate-100 mb-4 overflow-hidden">
            <div id="stProgress" class="h-full bg-gradient-to-r from-pink-500 to-purple-500 transition-all" style="width: 0%"></div>
          </div>
          <p id="stStat" class="text-slate-500 mt-2">Phrase 1/5 â€¢ WPM: --</p>
        </div>
      `;

      const phraseEl = container.querySelector('#stPhrase');
      const inputEl = container.querySelector('#stInput');
      const progress = container.querySelector('#stProgress');
      const stat = container.querySelector('#stStat');

      function showPhrase() {
        phraseEl.textContent = phrases[current];
        inputEl.value = '';
        startTime = Date.now();
      }

      inputEl.oninput = () => {
        const typed = inputEl.value;
        const target = phrases[current];
        const pct = (typed.length / target.length) * 100;
        progress.style.width = Math.min(100, pct) + '%';

        if (typed === target) {
          const elapsed = (Date.now() - startTime) / 1000;
          const words = target.split(' ').length;
          const wpm = Math.round((words / elapsed) * 60);
          score += Math.min(25, Math.max(5, Math.round(wpm / 5)));
          container.querySelector('.card').classList.add('game-correct');
          setTimeout(() => container.querySelector('.card').classList.remove('game-correct'), 400);
          current++;
          if (current >= 5) {
            stat.textContent = `Done! Final score: ${score}`;
            inputEl.disabled = true;
            postScore('speed_typer', score);
          } else {
            stat.textContent = `Phrase ${current + 1}/5 â€¢ Last: ${wpm} WPM`;
            showPhrase();
          }
        }
      };
      showPhrase();
      inputEl.focus();
    }

    function renderFlirtyDice(container) {
      const actions = ['ğŸ˜˜ Air kiss', 'ğŸ¤— Hug someone', 'ğŸ’ƒ Dance move', 'ğŸ¤ Sing a line', 'ğŸ˜ Cool pose', 'ğŸ¤ª Silly face'];
      const targets = ['your phone ğŸ“±', 'the screen ğŸ’»', 'the ceiling ğŸ ', 'your reflection ğŸª', 'nobody ğŸ˜‚', 'Molayman ğŸ§'];

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ²</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Spicy Dice</h3>
          <p class="text-slate-500 mb-4">Roll the dice for fun challenges! 5 rolls.</p>
          <div class="flex gap-4 justify-center mb-4">
            <div id="dice1" class="w-24 h-24 rounded-2xl bg-gradient-to-br from-red-400 to-pink-500 flex items-center justify-center text-4xl text-white font-bold shadow-lg">?</div>
            <div id="dice2" class="w-24 h-24 rounded-2xl bg-gradient-to-br from-purple-400 to-indigo-500 flex items-center justify-center text-4xl text-white font-bold shadow-lg">?</div>
          </div>
          <div id="diceResult" class="text-lg font-bold text-slate-700 py-4 px-4 bg-gradient-to-r from-pink-50 to-purple-50 rounded-2xl mb-4 min-h-[60px] flex items-center justify-center">
            Roll the dice!
          </div>
          <button id="diceRoll" class="game-btn-fun w-full text-xl py-4">ğŸ² ROLL!</button>
          <button id="diceDid" class="game-btn-primary w-full mt-2 hidden">âœ… I did it!</button>
          <p id="diceStat" class="text-slate-500 mt-4">5 rolls left â€¢ Score: 0</p>
        </div>
      `;

      let rolls = 5, score = 0;
      const dice1 = container.querySelector('#dice1');
      const dice2 = container.querySelector('#dice2');
      const result = container.querySelector('#diceResult');
      const rollBtn = container.querySelector('#diceRoll');
      const didBtn = container.querySelector('#diceDid');
      const stat = container.querySelector('#diceStat');

      rollBtn.onclick = () => {
        rollBtn.disabled = true;
        let ticks = 0;
        const interval = setInterval(() => {
          dice1.textContent = ['âš€','âš','âš‚','âšƒ','âš„','âš…'][Math.floor(Math.random()*6)];
          dice2.textContent = ['âš€','âš','âš‚','âšƒ','âš„','âš…'][Math.floor(Math.random()*6)];
          dice1.classList.add('wiggle'); dice2.classList.add('wiggle');
          ticks++;
          if (ticks > 12) {
            clearInterval(interval);
            dice1.classList.remove('wiggle'); dice2.classList.remove('wiggle');
            const action = actions[Math.floor(Math.random()*actions.length)];
            const target = targets[Math.floor(Math.random()*targets.length)];
            result.textContent = `${action} at ${target}`;
            result.classList.add('tada'); setTimeout(() => result.classList.remove('tada'), 800);
            rollBtn.classList.add('hidden');
            didBtn.classList.remove('hidden');
          }
        }, 80);
      };

      didBtn.onclick = () => {
        score += 12;
        rolls--;
        if (rolls <= 0) {
          stat.textContent = `All done! Score: ${score}`;
          didBtn.disabled = true;
          postScore('flirty_dice', score);
        } else {
          stat.textContent = `${rolls} rolls left â€¢ Score: ${score}`;
          rollBtn.classList.remove('hidden');
          rollBtn.disabled = false;
          didBtn.classList.add('hidden');
          result.textContent = 'Roll again!';
        }
      };
    }

    function renderMemeCaption(container) {
      const memes = [
        { emoji: 'ğŸ˜¤ğŸ‘‰ğŸ›ï¸', desc: 'Angry person pointing at bed', correct: 'Me telling myself to sleep at 3am', options: ['Me telling myself to sleep at 3am', 'When the bed is too comfortable', 'Monday morning energy'] },
        { emoji: 'ğŸ¶ğŸ”¥â˜•', desc: 'Dog in fire with coffee', correct: 'This is fine', options: ['This is fine', 'Dogs love coffee', 'Fire safety gone wrong'] },
        { emoji: 'ğŸ¦‹ğŸ¤”ğŸ‘ˆ', desc: 'Is this a butterfly?', correct: 'Is this a personality?', options: ['Is this a personality?', 'Butterfly catching tips', 'Nature documentary scene'] },
        { emoji: 'ğŸ˜ğŸ’ªğŸª', desc: 'Smug with muscles in mirror', correct: 'Me after doing one push-up', options: ['Gym motivation poster', 'Me after doing one push-up', 'Mirror shopping guide'] },
        { emoji: 'ğŸ§ ğŸ“ˆğŸ“‰', desc: 'Galaxy brain expanding', correct: 'Using 100% of the brain', options: ['Stock market tips', 'Using 100% of the brain', 'Brain surgery diagram'] },
        { emoji: 'ğŸ’€ğŸ“±ğŸ˜‚', desc: 'Dead from laughing at phone', correct: 'Reading texts in class', options: ['Phone repair service', 'Reading texts in class', 'New phone who dis'] },
        { emoji: 'ğŸ¤¡ğŸªğŸ˜­', desc: 'Clown in mirror crying', correct: 'Me looking at my life choices', options: ['Clown makeup tutorial', 'Mirror reflection study', 'Me looking at my life choices'] },
      ];
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in">
          <div class="text-5xl mb-4">ğŸ˜‚</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Meme Match</h3>
          <p class="text-slate-500 mb-4">Pick the right caption! 5 memes.</p>
          <div id="memeDisplay" class="text-6xl py-6">${memes[0].emoji}</div>
          <p class="text-sm text-slate-400 mb-3">What's the right caption?</p>
          <div id="memeOptions" class="space-y-2"></div>
          <p id="memeStat" class="text-slate-500 mt-4">Meme 1/5 â€¢ Score: 0</p>
        </div>
      `;

      const memeDisplay = container.querySelector('#memeDisplay');
      const optionsDiv = container.querySelector('#memeOptions');
      const stat = container.querySelector('#memeStat');

      function showMeme() {
        const m = memes[current];
        memeDisplay.textContent = m.emoji;
        memeDisplay.classList.add('bounce-in');
        setTimeout(() => memeDisplay.classList.remove('bounce-in'), 500);
        optionsDiv.innerHTML = '';
        const shuffled = [...m.options].sort(() => Math.random() - 0.5);
        shuffled.forEach(opt => {
          const btn = document.createElement('button');
          btn.className = 'game-btn-secondary w-full text-left';
          btn.textContent = opt;
          btn.onclick = () => {
            if (opt === m.correct) { score += 15; container.querySelector('.card').classList.add('game-correct'); }
            else { container.querySelector('.card').classList.add('game-wrong'); }
            setTimeout(() => container.querySelector('.card').classList.remove('game-correct', 'game-wrong'), 400);
            current++;
            if (current >= 5) { stat.textContent = `Done! Score: ${score}`; optionsDiv.innerHTML = '<p class="text-gradient font-bold">Great meme taste! ğŸ‰</p>'; postScore('meme_caption', score); }
            else { stat.textContent = `Meme ${current + 1}/5 â€¢ Score: ${score}`; showMeme(); }
          };
          optionsDiv.appendChild(btn);
        });
      }
      showMeme();
    }

    // ==================== ENHANCED EFFECTS ENGINE ====================

    // Particle explosion system
    function spawnParticles(x, y, count = 20, colors = ['#ef4444','#f59e0b','#6366f1','#ec4899','#10b981']) {
      for (let i = 0; i < count; i++) {
        const p = document.createElement('div');
        p.style.cssText = `position:fixed;left:${x}px;top:${y}px;width:${4+Math.random()*8}px;height:${4+Math.random()*8}px;border-radius:50%;background:${colors[Math.floor(Math.random()*colors.length)]};pointer-events:none;z-index:9999;`;
        document.body.appendChild(p);
        const angle = (Math.PI*2/count)*i;
        const speed = 2+Math.random()*6;
        const vx = Math.cos(angle)*speed;
        const vy = Math.sin(angle)*speed;
        let px = x, py = y, life = 1;
        (function animate() {
          px+=vx; py+=vy+1; life-=0.02;
          p.style.left=px+'px'; p.style.top=py+'px';
          p.style.opacity=life; p.style.transform=`scale(${life})`;
          if (life>0) requestAnimationFrame(animate);
          else p.remove();
        })();
      }
    }

    // Screen shake effect
    function screenShake(intensity = 5, duration = 300) {
      const el = document.getElementById('gameStage');
      if (!el) return;
      const start = Date.now();
      (function shake() {
        const elapsed = Date.now()-start;
        if (elapsed > duration) { el.style.transform=''; return; }
        const x = (Math.random()-0.5)*intensity*2;
        const y = (Math.random()-0.5)*intensity*2;
        el.style.transform = `translate(${x}px,${y}px)`;
        requestAnimationFrame(shake);
      })();
    }

    // Score popup floater
    function floatScore(text, x, y, color = '#10b981') {
      const el = document.createElement('div');
      el.textContent = text;
      el.style.cssText = `position:fixed;left:${x}px;top:${y}px;font-size:24px;font-weight:900;color:${color};pointer-events:none;z-index:9999;text-shadow:0 2px 8px rgba(0,0,0,0.2);`;
      document.body.appendChild(el);
      let posY = y, life = 1;
      (function animate() {
        posY -= 2; life -= 0.02;
        el.style.top = posY + 'px';
        el.style.opacity = life;
        el.style.transform = `scale(${0.8+life*0.4})`;
        if (life > 0) requestAnimationFrame(animate);
        else el.remove();
      })();
    }

    // Fire trail effect
    function fireTrail(element) {
      const rect = element.getBoundingClientRect();
      for (let i = 0; i < 5; i++) {
        setTimeout(() => {
          spawnParticles(rect.left+rect.width/2, rect.top+rect.height/2, 6, ['#ef4444','#f59e0b','#fbbf24','#ff6b00']);
        }, i*60);
      }
    }

    // Combo display
    let comboCount = 0;
    function showCombo(container) {
      comboCount++;
      if (comboCount < 2) return;
      let existing = container.querySelector('.combo-display');
      if (!existing) {
        existing = document.createElement('div');
        existing.className = 'combo-display';
        existing.style.cssText = 'position:absolute;top:10px;right:10px;font-size:20px;font-weight:900;color:#f59e0b;text-shadow:0 0 20px rgba(245,158,11,0.5);transition:all 0.3s ease;z-index:10;';
        container.style.position = 'relative';
        container.appendChild(existing);
      }
      existing.textContent = `ğŸ”¥ ${comboCount}x COMBO!`;
      existing.style.transform = 'scale(1.3)';
      setTimeout(() => existing.style.transform = 'scale(1)', 200);
      if (comboCount >= 5) {
        screenShake(3, 200);
        const rect = existing.getBoundingClientRect();
        spawnParticles(rect.left, rect.top, 15, ['#f59e0b','#ef4444','#ff6b00']);
      }
    }
    function resetCombo() { comboCount = 0; }

    // ==================== ADULTS ONLY GAME IMPLEMENTATIONS ====================

    function renderRoastMaster(container) {
      const roasts = [
        { target: "Your cooking ğŸ³", roasts: [
          "Your cooking is so bad, the smoke alarm cheers when you order takeout ğŸ”¥",
          "Gordon Ramsay would need therapy after tasting your food ğŸ˜­",
          "Even the microwave judges you ğŸ’€",
          "Your food could be classified as a biological weapon â˜¢ï¸"
        ]},
        { target: "Your fashion sense ğŸ‘—", roasts: [
          "You dress like your closet had a seizure ğŸ« ",
          "Did you pick that outfit with your eyes closed? Brave. ğŸ˜‚",
          "Fashion police called â€“ they're sending the SWAT team ğŸš”",
          "Your outfit screams 'I gave up on page 1 of life' ğŸ’€"
        ]},
        { target: "Your dance moves ğŸ’ƒ", roasts: [
          "You dance like you're being attacked by invisible bees ğŸ",
          "Your dance moves are a war crime in 37 countries ğŸŒ",
          "Even Siri would refuse to play music for those moves ğŸ“±",
          "You don't dance, you have a public seizure with rhythm ğŸ’€"
        ]},
        { target: "Your selfies ğŸ“¸", roasts: [
          "Your selfies have more filters than a water treatment plant ğŸ’§",
          "Even FaceApp can't fix what God gave up on ğŸ˜­",
          "Your front camera called â€“ it wants hazard pay ğŸ“·",
          "Your selfie just made my phone screen crack itself ğŸ’€"
        ]},
        { target: "Your texting ğŸ“±", roasts: [
          "You type like a cat walking on a keyboard ğŸ±",
          "Your texts are so dry they need an IV drip ğŸ¥",
          "You reply so slow, archaeologists could study your message history ğŸ¦´",
          "Your 'K' replies belong in a museum of heartbreak ğŸ’”"
        ]},
        { target: "Your morning face ğŸŒ…", roasts: [
          "Your morning face could scare away a horror movie villain ğŸ‘»",
          "Alarm clocks scream first when they see you wake up ğŸ˜±",
          "Mirrors file for PTSD claims after your morning routine ğŸª",
          "The sunrise takes one look at you and goes back down â˜€ï¸"
        ]},
      ];
      let round = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;overflow:hidden;">
          <div class="text-5xl mb-4 tada">ğŸ”¥</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Roast Master</h3>
          <p class="text-slate-500 mb-4">Rate the savageness! 5 rounds of pain. ğŸ’€</p>
          <div id="rmTarget" class="text-lg font-bold text-gradient py-2 mb-2"></div>
          <div id="rmRoast" class="text-lg text-slate-700 py-4 px-4 bg-gradient-to-r from-red-50 to-orange-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center italic"></div>
          <button id="rmGenerate" class="game-btn-danger w-full mb-3 text-lg">ğŸ”¥ Generate Roast!</button>
          <div id="rmRate" class="hidden space-y-2">
            <p class="text-sm text-slate-400">How savage was that?</p>
            <div class="flex gap-2 justify-center flex-wrap">
              <button class="roast-rate game-btn-secondary px-3 py-2 text-sm" data-val="1">1 Meh ğŸ˜</button>
              <button class="roast-rate game-btn-secondary px-3 py-2 text-sm" data-val="2">2 Ouch ğŸ˜¬</button>
              <button class="roast-rate game-btn-secondary px-3 py-2 text-sm" data-val="3">3 Damn ğŸ˜³</button>
              <button class="roast-rate game-btn-secondary px-3 py-2 text-sm" data-val="4">4 DEAD ğŸ’€</button>
              <button class="roast-rate game-btn-secondary px-3 py-2 text-sm" data-val="5">5 FUNERAL âš°ï¸</button>
            </div>
          </div>
          <p id="rmStat" class="text-slate-500 mt-4">Round 1/5 â€¢ Score: 0</p>
        </div>
      `;

      const targetEl = container.querySelector('#rmTarget');
      const roastEl = container.querySelector('#rmRoast');
      const genBtn = container.querySelector('#rmGenerate');
      const rateDiv = container.querySelector('#rmRate');
      const stat = container.querySelector('#rmStat');

      function showRoast() {
        const category = roasts[round % roasts.length];
        targetEl.textContent = 'ğŸ¯ Target: ' + category.target;
        const roast = category.roasts[Math.floor(Math.random()*category.roasts.length)];
        roastEl.textContent = roast;
        roastEl.classList.add('bounce-in');
        setTimeout(() => roastEl.classList.remove('bounce-in'), 500);
        screenShake(4, 300);
        spawnParticles(window.innerWidth/2, window.innerHeight/2, 15, ['#ef4444','#f59e0b','#ff6b00']);
      }

      genBtn.onclick = () => {
        showRoast();
        genBtn.classList.add('hidden');
        rateDiv.classList.remove('hidden');
      };

      container.querySelectorAll('.roast-rate').forEach(btn => {
        btn.onclick = (e) => {
          const val = parseInt(btn.dataset.val);
          score += val * 4;
          floatScore('+' + (val*4), e.clientX, e.clientY, '#ef4444');
          round++;
          if (round >= 5) {
            stat.textContent = `All roasted! Score: ${score} ğŸ”¥`;
            rateDiv.classList.add('hidden');
            postScore('roast_master', score);
          } else {
            stat.textContent = `Round ${round+1}/5 â€¢ Score: ${score}`;
            rateDiv.classList.add('hidden');
            genBtn.classList.remove('hidden');
            genBtn.textContent = 'ğŸ”¥ Next Roast!';
          }
        };
      });
    }

    function renderNsfwTrivia(container) {
      const questions = [
        { q: "What does 'MILF' technically stand for in internet slang?", options: ["Mom I'd Like to Friend","Mother In Large Family","Mom I'd Like to Follow","Man I Love Frogs"], correct: 3, fact: "It's actually 'Man I Love Frogs' ğŸ¸ (the wholesome version!)" },
        { q: "What body part grows the fastest?", options: ["Hair","Nails","Bone marrow","Nose hair"], correct: 0, fact: "Hair grows about 6 inches per year! ğŸ’‡" },
        { q: "The average person passes gas how many times a day?", options: ["5-8","10-12","14-23","30+"], correct: 2, fact: "14-23 times a day is totally normal! ğŸ’¨" },
        { q: "What's the most sensitive body part?", options: ["Tongue","Fingertips","Lips","Behind the ear"], correct: 1, fact: "Fingertips have the most nerve endings! ğŸ–ï¸" },
        { q: "How many calories does a passionate kiss burn?", options: ["2-3","6-8","12-15","26"], correct: 0, fact: "Sadly only 2-3 calories per kiss ğŸ˜˜" },
        { q: "Which animal has the longest tongue relative to body?", options: ["Giraffe","Chameleon","Anteater","Frog"], correct: 1, fact: "Chameleon tongues are 2x their body length! ğŸ¦" },
        { q: "What's the world's most common fetish?", options: ["Feet","Hands","Leather","Food"], correct: 0, fact: "Feet win this awkward trophy! ğŸ¦¶" },
        { q: "How many muscles does it take to kiss?", options: ["2","12","34","146"], correct: 2, fact: "34 muscles for a passionate kiss! ğŸ’‹" },
      ];
      let current = 0, score = 0;
      const shuffled = questions.sort(() => Math.random()-0.5).slice(0,5);

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">ğŸ”</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">NSFW Trivia</h3>
          <p class="text-slate-500 mb-4">Embarrassing facts you'll never un-know! 5 Qs.</p>
          <div id="ntQuestion" class="text-lg font-bold text-slate-700 py-4 px-4 bg-gradient-to-r from-pink-50 to-red-50 rounded-2xl mb-4 min-h-[60px]"></div>
          <div id="ntOptions" class="space-y-2 mb-3"></div>
          <div id="ntFact" class="hidden text-sm text-slate-500 py-3 px-4 bg-yellow-50 rounded-xl mb-3"></div>
          <button id="ntNext" class="game-btn-fun w-full hidden">Next Question â†’</button>
          <p id="ntStat" class="text-slate-500 mt-4">Q 1/5 â€¢ Score: 0</p>
        </div>
      `;

      const qEl = container.querySelector('#ntQuestion');
      const optDiv = container.querySelector('#ntOptions');
      const factEl = container.querySelector('#ntFact');
      const nextBtn = container.querySelector('#ntNext');
      const stat = container.querySelector('#ntStat');

      function showQuestion() {
        const q = shuffled[current];
        qEl.textContent = q.q;
        qEl.classList.add('bounce-in');
        setTimeout(() => qEl.classList.remove('bounce-in'), 500);
        optDiv.innerHTML = '';
        factEl.classList.add('hidden');
        nextBtn.classList.add('hidden');
        q.options.forEach((opt, i) => {
          const btn = document.createElement('button');
          btn.className = 'game-btn-secondary w-full text-left text-sm';
          btn.textContent = opt;
          btn.onclick = (e) => {
            optDiv.querySelectorAll('button').forEach(b => b.disabled = true);
            if (i === q.correct) {
              score += 15;
              btn.style.background = 'linear-gradient(135deg,#10b981,#34d399)';
              btn.style.color = 'white';
              btn.style.borderColor = '#10b981';
              floatScore('+15', e.clientX, e.clientY);
              showCombo(container);
              spawnParticles(e.clientX, e.clientY, 12, ['#10b981','#34d399','#6ee7b7']);
            } else {
              btn.style.background = '#ef4444';
              btn.style.color = 'white';
              optDiv.children[q.correct].style.background = 'linear-gradient(135deg,#10b981,#34d399)';
              optDiv.children[q.correct].style.color = 'white';
              screenShake(5, 300);
              resetCombo();
            }
            factEl.textContent = 'ğŸ’¡ ' + q.fact;
            factEl.classList.remove('hidden');
            nextBtn.classList.remove('hidden');
          };
          optDiv.appendChild(btn);
        });
      }

      nextBtn.onclick = () => {
        current++;
        if (current >= 5) {
          stat.textContent = `Done! Final: ${score}`;
          postScore('nsfw_trivia', score);
        } else {
          stat.textContent = `Q ${current+1}/5 â€¢ Score: ${score}`;
          showQuestion();
        }
      };
      showQuestion();
    }

    function renderAwkwardConfess(container) {
      const confessions = [
        "I once waved back at someone who wasn't waving at me... then pretended to stretch ğŸ™‹â€â™‚ï¸",
        "I stalked my ex so deep on social media I accidentally liked a photo from 2017 ğŸ’€",
        "I called my teacher 'Mom' in front of the entire class in 10th grade ğŸ˜­",
        "I sent a screenshot OF the conversation TO the person in the conversation ğŸ“±",
        "I walked into a glass door at a fancy restaurant while people watched ğŸšª",
        "I replied 'you too' when the waiter said 'enjoy your meal' ğŸ½ï¸",
        "I ugly cried during a job interview because they asked about my strengths ğŸ˜¢",
        "I accidentally sent a love message to my group chat instead of my crush ğŸ’",
        "I got caught talking to myself in a public bathroom mirror ğŸª",
        "I waved goodbye on a phone call... while alone in my room ğŸ‘‹",
        "I tried to push a pull door for a solid 30 seconds while someone watched ğŸšª",
        "I accidentally flushed my phone down the toilet at a party ğŸš½",
        "I tripped on flat ground and pretended to tie my shoes (wearing slip-ons) ğŸ‘Ÿ",
        "I thought someone said 'I love you' on the phone but they said 'olive juice' ğŸ«’",
      ];
      let shuffled = confessions.sort(() => Math.random()-0.5);
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">ğŸ˜³</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Cringe Confessions</h3>
          <p class="text-slate-500 mb-4">Rate the cringe level! 6 confessions.</p>
          <div id="acText" class="text-lg text-slate-700 py-6 px-4 bg-gradient-to-r from-purple-50 to-pink-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center italic"></div>
          <div class="flex gap-2 justify-center flex-wrap mb-3">
            <button class="cringe-btn game-btn-secondary px-3 py-2 text-sm" data-val="1">ğŸ˜ Mild</button>
            <button class="cringe-btn game-btn-secondary px-3 py-2 text-sm" data-val="2">ğŸ˜¬ Oof</button>
            <button class="cringe-btn game-btn-secondary px-3 py-2 text-sm" data-val="3">ğŸ«£ Yikes</button>
            <button class="cringe-btn game-btn-secondary px-3 py-2 text-sm" data-val="4">ğŸ˜­ DYING</button>
            <button class="cringe-btn game-btn-secondary px-3 py-2 text-sm" data-val="5">ğŸ’€ R.I.P.</button>
          </div>
          <p id="acStat" class="text-slate-500 mt-4">Confession 1/6 â€¢ Score: 0</p>
        </div>
      `;

      const textEl = container.querySelector('#acText');
      const stat = container.querySelector('#acStat');

      function showConfession() {
        textEl.textContent = '"' + shuffled[current] + '"';
        textEl.classList.add('bounce-in');
        setTimeout(() => textEl.classList.remove('bounce-in'), 500);
      }

      container.querySelectorAll('.cringe-btn').forEach(btn => {
        btn.onclick = (e) => {
          const val = parseInt(btn.dataset.val);
          score += val * 3;
          floatScore('+' + (val*3), e.clientX, e.clientY, '#a855f7');
          if (val >= 4) {
            screenShake(3, 200);
            spawnParticles(e.clientX, e.clientY, 10, ['#a855f7','#ec4899','#f43f5e']);
          }
          current++;
          if (current >= 6) {
            stat.textContent = `All cringed out! Score: ${score}`;
            container.querySelectorAll('.cringe-btn').forEach(b => b.disabled = true);
            postScore('awkward_confess', score);
          } else {
            stat.textContent = `Confession ${current+1}/6 â€¢ Score: ${score}`;
            showConfession();
          }
        };
      });
      showConfession();
    }

    function renderDirtyMind(container) {
      const riddles = [
        { q: "I go in hard, come out soft, and you love to blow me. What am I?", a: "Bubblegum ğŸ«§", wrong: "Something else ğŸ˜" },
        { q: "I'm long, hard, and full of seamen. What am I?", a: "A submarine ğŸš¢", wrong: "That's sus ğŸ˜³" },
        { q: "You stick your poles inside me. You tie me down to get me up. What am I?", a: "A tent â›º", wrong: "Oh my... ğŸ™ˆ" },
        { q: "The more you play with me, the harder I get. What am I?", a: "A Rubik's Cube ğŸ§©", wrong: "Your mind is dirty! ğŸ˜‚" },
        { q: "I come in different sizes. Some people blow me. Kids love playing with me. What am I?", a: "A balloon ğŸˆ", wrong: "You're canceled ğŸ’€" },
        { q: "I go in dry and come out wet. The longer I'm in, the stronger I get. What am I?", a: "A tea bag â˜•", wrong: "Keep it PG! ğŸ¤£" },
        { q: "You put your hand in me, squeeze and I squirt. What am I?", a: "A ketchup bottle ğŸ…", wrong: "JAIL ğŸš¨" },
        { q: "What starts with 'p' and ends with 'orn'?", a: "Popcorn ğŸ¿", wrong: "I see where your mind went ğŸ˜ˆ" },
      ];
      let shuffled = riddles.sort(() => Math.random()-0.5).slice(0,5);
      let current = 0, score = 0, dirtyScore = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">ğŸ§ </div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Dirty Mind Test</h3>
          <p class="text-slate-500 mb-4">Get your mind out of the gutter! 5 riddles.</p>
          <div id="dmMeter" class="mb-4">
            <div class="text-sm text-slate-400 mb-1">Dirty Mind Meter ğŸŒ¡ï¸</div>
            <div class="h-4 rounded-full bg-slate-100 overflow-hidden">
              <div id="dmFill" class="h-full bg-gradient-to-r from-green-500 via-yellow-500 to-red-500 transition-all duration-500" style="width:0%"></div>
            </div>
            <div class="flex justify-between text-xs text-slate-400 mt-1"><span>Pure âœ¨</span><span>FILTHY ğŸ¤®</span></div>
          </div>
          <div id="dmQuestion" class="text-lg text-slate-700 py-6 px-4 bg-gradient-to-r from-amber-50 to-red-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center italic font-bold"></div>
          <div id="dmAnswer" class="hidden text-lg font-bold py-3 px-4 rounded-2xl mb-3"></div>
          <div id="dmBtns" class="flex gap-3">
            <button id="dmClean" class="game-btn-primary flex-1 text-lg">ğŸ˜‡ I know it!</button>
            <button id="dmDirty" class="game-btn-danger flex-1 text-lg">ğŸ˜ˆ It's dirty...</button>
          </div>
          <button id="dmNext" class="game-btn-fun w-full hidden mt-2">Next Riddle â†’</button>
          <p id="dmStat" class="text-slate-500 mt-4">Riddle 1/5 â€¢ Clean: 0 | Dirty: 0</p>
        </div>
      `;

      const qEl = container.querySelector('#dmQuestion');
      const ansEl = container.querySelector('#dmAnswer');
      const cleanBtn = container.querySelector('#dmClean');
      const dirtyBtn = container.querySelector('#dmDirty');
      const nextBtn = container.querySelector('#dmNext');
      const stat = container.querySelector('#dmStat');
      const fill = container.querySelector('#dmFill');
      const btnsDiv = container.querySelector('#dmBtns');

      function showRiddle() {
        qEl.textContent = shuffled[current].q;
        qEl.classList.add('bounce-in');
        setTimeout(() => qEl.classList.remove('bounce-in'), 500);
        ansEl.classList.add('hidden');
        nextBtn.classList.add('hidden');
        btnsDiv.classList.remove('hidden');
      }

      function answer(isDirty) {
        btnsDiv.classList.add('hidden');
        const riddle = shuffled[current];
        if (isDirty) {
          dirtyScore++;
          ansEl.textContent = `${riddle.wrong} â€” The answer is: ${riddle.a}`;
          ansEl.style.background = 'linear-gradient(135deg,#fecaca,#fee2e2)';
          screenShake(6, 400);
          score += 8;
        } else {
          ansEl.textContent = `Correct! It's: ${riddle.a}`;
          ansEl.style.background = 'linear-gradient(135deg,#d1fae5,#ecfdf5)';
          score += 15;
          showCombo(container);
          const rect = cleanBtn.getBoundingClientRect();
          spawnParticles(rect.left+rect.width/2, rect.top, 12, ['#10b981','#34d399']);
        }
        ansEl.classList.remove('hidden');
        ansEl.classList.add('bounce-in');
        fill.style.width = (dirtyScore/5*100) + '%';
        nextBtn.classList.remove('hidden');
      }

      cleanBtn.onclick = () => answer(false);
      dirtyBtn.onclick = () => answer(true);
      nextBtn.onclick = () => {
        current++;
        if (current >= 5) {
          const verdict = dirtyScore >= 4 ? 'ğŸ¤® FILTHY MIND!' : dirtyScore >= 2 ? 'ğŸ˜ Kinda sus...' : 'ğŸ˜‡ Pure soul!';
          stat.textContent = `${verdict} Score: ${score} | Dirty: ${dirtyScore}/5`;
          nextBtn.classList.add('hidden');
          postScore('dirty_mind', score);
        } else {
          stat.textContent = `Riddle ${current+1}/5 â€¢ Clean: ${current-dirtyScore} | Dirty: ${dirtyScore}`;
          showRiddle();
        }
      };
      showRiddle();
    }

    function renderBootyShake(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;overflow:hidden;">
          <div class="text-5xl mb-4">ğŸ‘</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Booty Shake Challenge</h3>
          <p class="text-slate-500 mb-4">Shake your phone or click the button to the beat! ğŸ¶</p>
          <div id="bsEmoji" class="text-8xl py-6 transition-transform">ğŸ‘</div>
          <div class="h-6 rounded-full bg-slate-100 overflow-hidden mb-4">
            <div id="bsBar" class="h-full bg-gradient-to-r from-pink-500 via-fuchsia-500 to-purple-500 transition-all" style="width:0%"></div>
          </div>
          <div id="bsBeat" class="text-3xl font-black text-gradient mb-2 h-10"></div>
          <button id="bsStart" class="game-btn-fun w-full text-xl py-4 mb-2">ğŸ¶ Start Shaking!</button>
          <button id="bsShake" class="game-btn-danger w-full text-2xl py-6 hidden pulse-glow">ğŸ‘ SHAKE IT! ğŸ‘</button>
          <p id="bsStat" class="text-slate-500 mt-4">Shake to fill the meter!</p>
        </div>
      `;

      let shakes = 0, running = false, beatPhase = 0;
      const emoji = container.querySelector('#bsEmoji');
      const bar = container.querySelector('#bsBar');
      const beat = container.querySelector('#bsBeat');
      const startBtn = container.querySelector('#bsStart');
      const shakeBtn = container.querySelector('#bsShake');
      const stat = container.querySelector('#bsStat');
      const beats = ['ğŸ”Š BOOM!','ğŸ’¥ CLAP!','ğŸµ DROP!','ğŸ‘ SHAKE!','ğŸ”¥ TWERK!','ğŸ’ƒ MOVE!'];

      startBtn.onclick = () => {
        running = true; shakes = 0;
        startBtn.classList.add('hidden');
        shakeBtn.classList.remove('hidden');
        let timeLeft = 12;
        const timer = setInterval(() => {
          timeLeft--;
          beatPhase = (beatPhase+1) % beats.length;
          beat.textContent = beats[beatPhase];
          beat.classList.add('tada');
          setTimeout(() => beat.classList.remove('tada'), 400);
          emoji.style.transform = `rotate(${(Math.random()-0.5)*30}deg) scale(${1+Math.random()*0.3})`;
          if (timeLeft <= 0) {
            clearInterval(timer);
            running = false;
            shakeBtn.disabled = true;
            const score = Math.min(100, shakes * 2);
            const verdict = score >= 80 ? 'ğŸ† TWERK MASTER!' : score >= 50 ? 'ğŸ’ƒ Nice moves!' : 'ğŸ«  Needs practice';
            stat.textContent = `${verdict} Shakes: ${shakes} | Score: ${score}`;
            if (score >= 60) launchConfetti(50);
            postScore('booty_shake', score);
          }
        }, 1000);
      };

      shakeBtn.onclick = (e) => {
        if (!running) return;
        shakes++;
        bar.style.width = Math.min(100, shakes*2) + '%';
        stat.textContent = `Shakes: ${shakes}`;
        emoji.style.transform = `rotate(${(Math.random()-0.5)*45}deg) scale(1.3)`;
        setTimeout(() => emoji.style.transform = 'rotate(0) scale(1)', 150);
        shakeBtn.classList.add('wiggle');
        setTimeout(() => shakeBtn.classList.remove('wiggle'), 200);
        if (shakes % 10 === 0) {
          spawnParticles(e.clientX, e.clientY, 8, ['#ec4899','#f43f5e','#a855f7']);
          floatScore('ğŸ‘+' + (shakes), e.clientX, e.clientY-30, '#ec4899');
        }
      };

      // Device motion support
      if (window.DeviceMotionEvent) {
        window.addEventListener('devicemotion', (e) => {
          if (!running) return;
          const acc = e.accelerationIncludingGravity;
          if (acc && (Math.abs(acc.x)>12 || Math.abs(acc.y)>12 || Math.abs(acc.z)>20)) {
            shakes++;
            bar.style.width = Math.min(100, shakes*2) + '%';
            emoji.style.transform = `rotate(${(Math.random()-0.5)*45}deg)`;
          }
        });
      }
    }

    function renderSavageComeback(container) {
      const scenarios = [
        { insult: "You're ugly ğŸ¤¢", comebacks: [
          { text: "And you're rude, at least I can get plastic surgery ğŸ’…", savage: 5 },
          { text: "Mirror must be broken at your place ğŸª", savage: 3 },
          { text: "That's what your mom said... wait ğŸ¤”", savage: 4 },
        ]},
        { insult: "Nobody likes you ğŸ˜’", comebacks: [
          { text: "My bank account doesn't need friends ğŸ’°", savage: 5 },
          { text: "Quality over quantity, sweetheart ğŸ’", savage: 3 },
          { text: "Your imaginary friends don't count either ğŸ‘»", savage: 4 },
        ]},
        { insult: "You're so cringe ğŸ¤®", comebacks: [
          { text: "Thanks! I worked harder on this than you did on your personality ğŸ­", savage: 5 },
          { text: "At least I have a personality to cringe at ğŸ’€", savage: 4 },
          { text: "Better cringe than boring like you ğŸ¥±", savage: 3 },
        ]},
        { insult: "You'll never be successful ğŸ“‰", comebacks: [
          { text: "Tell that to my trust fund ğŸ¦", savage: 4 },
          { text: "I wasn't put on this earth to impress you ğŸŒ", savage: 3 },
          { text: "Keep watching, I'll send you a postcard from the top ğŸ“®", savage: 5 },
        ]},
        { insult: "Your outfit is terrible ğŸ‘", comebacks: [
          { text: "It costs more than your rent but go off ğŸ’¸", savage: 5 },
          { text: "Fashion police called, they said you're under arrest too ğŸš”", savage: 4 },
          { text: "At least I don't dress like a before photo ğŸ“¸", savage: 4 },
        ]},
        { insult: "You have no skills ğŸ¤·", comebacks: [
          { text: "My skill is ignoring people like you ğŸ¯", savage: 4 },
          { text: "I have the skill of not caring what you think ğŸ’…", savage: 3 },
          { text: "I'm skilled at making haters like you waste their time ğŸ•°ï¸", savage: 5 },
        ]},
      ];
      let shuffled = scenarios.sort(() => Math.random()-0.5).slice(0,5);
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">ğŸ’€</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Savage Comebacks</h3>
          <p class="text-slate-500 mb-4">Pick the most savage reply! 5 battles.</p>
          <div id="scInsult" class="text-xl font-bold text-red-600 py-4 px-4 bg-red-50 rounded-2xl mb-4"></div>
          <p class="text-sm text-slate-400 mb-2">Choose the most savage comeback:</p>
          <div id="scOptions" class="space-y-2 mb-3"></div>
          <p id="scStat" class="text-slate-500 mt-4">Battle 1/5 â€¢ Score: 0</p>
        </div>
      `;

      const insultEl = container.querySelector('#scInsult');
      const optDiv = container.querySelector('#scOptions');
      const stat = container.querySelector('#scStat');

      function showBattle() {
        const s = shuffled[current];
        insultEl.textContent = 'ğŸ’¬ ' + s.insult;
        insultEl.classList.add('shake');
        setTimeout(() => insultEl.classList.remove('shake'), 500);
        optDiv.innerHTML = '';
        const sorted = [...s.comebacks].sort(() => Math.random()-0.5);
        sorted.forEach(cb => {
          const btn = document.createElement('button');
          btn.className = 'game-btn-secondary w-full text-left text-sm';
          btn.textContent = cb.text;
          btn.onclick = (e) => {
            optDiv.querySelectorAll('button').forEach(b => b.disabled = true);
            const points = cb.savage * 4;
            score += points;
            floatScore('+' + points, e.clientX, e.clientY, '#ef4444');
            if (cb.savage === 5) {
              btn.style.background = 'linear-gradient(135deg,#ef4444,#f43f5e)';
              btn.style.color = 'white';
              screenShake(6, 400);
              spawnParticles(e.clientX, e.clientY, 25, ['#ef4444','#f97316','#fbbf24','ğŸ’€']);
              launchConfetti(30);
            } else if (cb.savage >= 4) {
              btn.style.background = 'linear-gradient(135deg,#f59e0b,#fbbf24)';
              btn.style.color = 'white';
            } else {
              btn.style.background = '#e2e8f0';
            }
            setTimeout(() => {
              current++;
              if (current >= 5) {
                stat.textContent = `MASSACRE COMPLETE! Score: ${score} ğŸ’€`;
                postScore('savage_comeback', score);
              } else {
                stat.textContent = `Battle ${current+1}/5 â€¢ Score: ${score}`;
                showBattle();
              }
            }, 1200);
          };
          optDiv.appendChild(btn);
        });
      }
      showBattle();
    }

    function renderNeverHaveI(container) {
      const statements = [
        "Never have I ever... pretended to text to avoid someone ğŸ“±",
        "Never have I ever... Googled my own name ğŸ”",
        "Never have I ever... eaten food off the floor ğŸ•",
        "Never have I ever... practiced my acceptance speech in the mirror ğŸ†",
        "Never have I ever... sniffed my own armpit in public ğŸ«¢",
        "Never have I ever... laughed so hard I peed a little ğŸ˜‚",
        "Never have I ever... been caught picking my nose ğŸ‘ƒ",
        "Never have I ever... danced alone in my room like nobody's watching ğŸ’ƒ",
        "Never have I ever... pretended to be on the phone to avoid awkward situations ğŸ“",
        "Never have I ever... cyber-stalked an ex at 3am ğŸ•",
        "Never have I ever... eaten an entire cake by myself ğŸ‚",
        "Never have I ever... farted and blamed it on someone else ğŸ’¨",
        "Never have I ever... accidentally liked an old photo while stalking someone ğŸ‘",
        "Never have I ever... sent a risky text and immediately regretted it âœ‰ï¸",
        "Never have I ever... pretended to know a celebrity I've never heard of â­",
        "Never have I ever... ugly cried in a public restroom ğŸš»",
      ];
      let shuffled = statements.sort(() => Math.random()-0.5);
      let current = 0, score = 0, guiltCount = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">âœ‹</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Never Have I Ever</h3>
          <p class="text-slate-500 mb-4">Be honest! 8 rounds. ğŸ¤«</p>
          <div id="nhiGuiltMeter" class="mb-4">
            <div class="text-sm text-slate-400 mb-1">Guilt-O-Meter ğŸ˜ˆ</div>
            <div class="h-4 rounded-full bg-slate-100 overflow-hidden">
              <div id="nhiFill" class="h-full bg-gradient-to-r from-emerald-500 via-amber-500 to-red-500 transition-all duration-500" style="width:0%"></div>
            </div>
          </div>
          <div id="nhiText" class="text-xl font-bold text-slate-700 py-6 px-4 bg-gradient-to-r from-rose-50 to-pink-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center"></div>
          <div class="flex gap-4 mb-2">
            <button id="nhiInnocent" class="game-btn-primary flex-1 text-lg">ğŸ˜‡ Never!</button>
            <button id="nhiGuilty" class="game-btn-danger flex-1 text-lg">ğŸ˜ˆ I have...</button>
          </div>
          <p id="nhiStat" class="text-slate-500 mt-4">Round 1/8</p>
        </div>
      `;

      const textEl = container.querySelector('#nhiText');
      const innocentBtn = container.querySelector('#nhiInnocent');
      const guiltyBtn = container.querySelector('#nhiGuilty');
      const stat = container.querySelector('#nhiStat');
      const fill = container.querySelector('#nhiFill');

      function showStatement() {
        textEl.textContent = shuffled[current];
        textEl.classList.add('bounce-in');
        setTimeout(() => textEl.classList.remove('bounce-in'), 500);
      }

      function answer(guilty, e) {
        if (guilty) {
          guiltCount++;
          score += 12;
          floatScore('ğŸ˜ˆ +12', e.clientX, e.clientY, '#ef4444');
          screenShake(3, 200);
        } else {
          score += 6;
          floatScore('ğŸ˜‡ +6', e.clientX, e.clientY, '#10b981');
        }
        fill.style.width = (guiltCount/8*100) + '%';
        current++;
        if (current >= 8) {
          const verdict = guiltCount >= 6 ? 'ğŸ”¥ You are WILD!' : guiltCount >= 3 ? 'ğŸ˜ A little sneaky...' : 'ğŸ‘¼ Too pure for this world!';
          stat.textContent = `${verdict} â€¢ Guilty: ${guiltCount}/8 â€¢ Score: ${score}`;
          innocentBtn.disabled = true;
          guiltyBtn.disabled = true;
          if (guiltCount >= 5) launchConfetti(40);
          postScore('never_have_i', score);
        } else {
          stat.textContent = `Round ${current+1}/8 â€¢ Guilty: ${guiltCount}`;
          showStatement();
        }
      }

      innocentBtn.onclick = (e) => answer(false, e);
      guiltyBtn.onclick = (e) => answer(true, e);
      showStatement();
    }

    function renderCursedCompliment(container) {
      const compliments = [
        { text: "You're really pretty... for someone who doesn't try ğŸ’…", level: 4 },
        { text: "You're so brave for wearing that outfit in public ğŸ‘—", level: 5 },
        { text: "Wow, you clean up nice! You're barely recognizable! ğŸª", level: 4 },
        { text: "You have a great face for radio! ğŸ“»", level: 5 },
        { text: "You're not as dumb as you look! ğŸ§ ", level: 3 },
        { text: "You look great! Is that a new face? ğŸ˜‚", level: 5 },
        { text: "Your cooking is getting better! It's almost edible now! ğŸ³", level: 4 },
        { text: "You're like a software update â€” nobody asked for you but here you are! ğŸ’»", level: 5 },
        { text: "You have a unique look. Really unique. Like... really. ğŸ¤”", level: 3 },
        { text: "You're proof that even the participation trophies have meaning! ğŸ†", level: 4 },
        { text: "I admire your confidence! I could never leave the house like that. ğŸš¶", level: 5 },
        { text: "You're so funny! Not on purpose, but still! ğŸ˜‚", level: 3 },
        { text: "Your energy is... something. I mean, it's definitely something. âš¡", level: 2 },
        { text: "You must be VERY comfortable with who you are ğŸ« ", level: 4 },
      ];
      let shuffled = compliments.sort(() => Math.random()-0.5);
      let current = 0, score = 0;

      container.innerHTML = `
        <div class="card rounded-3xl p-8 text-center bounce-in" style="position:relative;">
          <div class="text-5xl mb-4">ğŸ¤®</div>
          <h3 class="text-2xl font-bold text-slate-800 mb-2">Cursed Compliments</h3>
          <p class="text-slate-500 mb-4">Rate how backhanded these are! 6 rounds.</p>
          <div id="ccText" class="text-lg text-slate-700 py-6 px-4 bg-gradient-to-r from-lime-50 to-emerald-50 rounded-2xl mb-4 min-h-[80px] flex items-center justify-center italic"></div>
          <p class="text-sm text-slate-400 mb-2">How cursed is this "compliment"?</p>
          <div class="flex gap-2 justify-center flex-wrap mb-3">
            <button class="curse-btn game-btn-secondary px-3 py-2 text-sm" data-val="1">ğŸ˜Š Sweet</button>
            <button class="curse-btn game-btn-secondary px-3 py-2 text-sm" data-val="2">ğŸ¤¨ Hmm</button>
            <button class="curse-btn game-btn-secondary px-3 py-2 text-sm" data-val="3">ğŸ˜¬ Shade</button>
            <button class="curse-btn game-btn-secondary px-3 py-2 text-sm" data-val="4">ğŸ’€ Cursed</button>
            <button class="curse-btn game-btn-secondary px-3 py-2 text-sm" data-val="5">â˜ ï¸ EVIL</button>
          </div>
          <p id="ccStat" class="text-slate-500 mt-4">Round 1/6 â€¢ Score: 0</p>
        </div>
      `;

      const textEl = container.querySelector('#ccText');
      const stat = container.querySelector('#ccStat');

      function showCompliment() {
        textEl.textContent = '"' + shuffled[current].text + '"';
        textEl.classList.add('bounce-in');
        setTimeout(() => textEl.classList.remove('bounce-in'), 500);
      }

      container.querySelectorAll('.curse-btn').forEach(btn => {
        btn.onclick = (e) => {
          const val = parseInt(btn.dataset.val);
          const actual = shuffled[current].level;
          const diff = Math.abs(val - actual);
          let points = 0;
          if (diff === 0) { points = 20; floatScore('PERFECT +20!', e.clientX, e.clientY, '#10b981'); spawnParticles(e.clientX, e.clientY, 15, ['#10b981','#34d399']); showCombo(container); }
          else if (diff === 1) { points = 12; floatScore('+12', e.clientX, e.clientY, '#6366f1'); }
          else { points = 5; floatScore('+5', e.clientX, e.clientY, '#94a3b8'); resetCombo(); }
          score += points;
          current++;
          if (current >= 6) {
            const verdict = score >= 90 ? 'ğŸ¯ Shade Detective!' : score >= 60 ? 'ğŸ˜ Good instincts' : 'ğŸ«  Too innocent';
            stat.textContent = `${verdict} â€¢ Score: ${score}`;
            container.querySelectorAll('.curse-btn').forEach(b => b.disabled = true);
            postScore('cursed_compliment', score);
          } else {
            stat.textContent = `Round ${current+1}/6 â€¢ Score: ${score}`;
            showCompliment();
          }
        };
      });
      showCompliment();
    }

    // ==================== HIGH-GRAPHICS CANVAS 18+ GAMES ====================

    // -------- 1. STRIP PONG - Full canvas pong game --------
    function renderStripPong(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#1a0a2e,#2d1b69);border:2px solid #f43f5e;">
          <h3 class="text-2xl font-bold text-pink-400 mb-2">ğŸ“ Strip Pong</h3>
          <p class="text-pink-200 text-sm mb-3">Beat the AI paddle! Score 7 to win big ğŸ”</p>
          <canvas id="spCanvas" width="600" height="400" style="border:2px solid #f43f5e;border-radius:16px;max-width:100%;background:#0a0015;cursor:none;display:block;margin:0 auto;"></canvas>
          <div class="mt-3 flex justify-center gap-6">
            <span class="text-2xl font-black text-pink-400" id="spPlayerScore">0</span>
            <span class="text-xl text-pink-300">vs</span>
            <span class="text-2xl font-black text-purple-400" id="spAiScore">0</span>
          </div>
          <p class="text-pink-300 text-xs mt-2" id="spStatus">Move mouse/touch to control paddle</p>
        </div>`;

      const canvas = document.getElementById('spCanvas');
      const ctx = canvas.getContext('2d');
      let playerScore = 0, aiScore = 0;
      const ball = { x: 300, y: 200, vx: 4, vy: 3, r: 10, trail: [] };
      const player = { x: 20, y: 160, w: 14, h: 80, color: '#f43f5e' };
      const ai = { x: 566, y: 160, w: 14, h: 80, color: '#8b5cf6' };
      let particles = [];
      let running = true;
      let hue = 0;

      canvas.addEventListener('mousemove', e => {
        const r = canvas.getBoundingClientRect();
        player.y = ((e.clientY - r.top) / r.height) * 400 - player.h / 2;
        player.y = Math.max(0, Math.min(400 - player.h, player.y));
      });
      canvas.addEventListener('touchmove', e => {
        e.preventDefault();
        const r = canvas.getBoundingClientRect();
        player.y = ((e.touches[0].clientY - r.top) / r.height) * 400 - player.h / 2;
        player.y = Math.max(0, Math.min(400 - player.h, player.y));
      }, { passive: false });

      function spawnHitParticles(x, y, color) {
        for (let i = 0; i < 15; i++) {
          particles.push({
            x, y, vx: (Math.random() - 0.5) * 10, vy: (Math.random() - 0.5) * 10,
            life: 1, color, size: 3 + Math.random() * 5
          });
        }
      }

      function resetBall() {
        ball.x = 300; ball.y = 200;
        ball.vx = (Math.random() > 0.5 ? 1 : -1) * 4;
        ball.vy = (Math.random() - 0.5) * 6;
        ball.trail = [];
      }

      function update() {
        if (!running) return;
        hue = (hue + 0.5) % 360;

        // Ball trail
        ball.trail.push({ x: ball.x, y: ball.y });
        if (ball.trail.length > 20) ball.trail.shift();

        ball.x += ball.vx;
        ball.y += ball.vy;

        // Top/bottom bounce
        if (ball.y - ball.r < 0 || ball.y + ball.r > 400) {
          ball.vy *= -1;
          spawnHitParticles(ball.x, ball.y, '#fbbf24');
        }

        // AI movement
        const aiCenter = ai.y + ai.h / 2;
        const diff = ball.y - aiCenter;
        ai.y += diff * 0.06;
        ai.y = Math.max(0, Math.min(400 - ai.h, ai.y));

        // Paddle collision
        if (ball.x - ball.r < player.x + player.w && ball.y > player.y && ball.y < player.y + player.h && ball.vx < 0) {
          ball.vx = Math.min(Math.abs(ball.vx) * 1.02, 10);
          ball.vy += (ball.y - (player.y + player.h / 2)) * 0.12;
          spawnHitParticles(ball.x, ball.y, '#f43f5e');
          screenShake(3, 150);
        }
        if (ball.x + ball.r > ai.x && ball.y > ai.y && ball.y < ai.y + ai.h && ball.vx > 0) {
          ball.vx = -Math.min(Math.abs(ball.vx) * 1.02, 10);
          ball.vy += (ball.y - (ai.y + ai.h / 2)) * 0.12;
          spawnHitParticles(ball.x, ball.y, '#8b5cf6');
        }

        // Scoring
        if (ball.x < -20) {
          aiScore++;
          document.getElementById('spAiScore').textContent = aiScore;
          screenShake(8, 300);
          spawnHitParticles(0, ball.y, '#ef4444');
          resetBall();
        }
        if (ball.x > 620) {
          playerScore++;
          document.getElementById('spPlayerScore').textContent = playerScore;
          spawnHitParticles(600, ball.y, '#10b981');
          resetBall();
        }

        // Particles update
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.03; p.vy += 0.1;
          return p.life > 0;
        });

        // Win check
        if (playerScore >= 7 || aiScore >= 7) {
          running = false;
          const score = playerScore >= 7 ? 100 : Math.max(10, playerScore * 12);
          document.getElementById('spStatus').textContent = playerScore >= 7 ? 'ğŸ‰ YOU WIN! Clothes coming off!' : 'ğŸ˜ˆ AI wins... you strip!';
          if (playerScore >= 7) launchConfetti(120);
          postScore('strip_pong', score);
        }
      }

      function draw() {
        ctx.fillStyle = '#0a0015';
        ctx.fillRect(0, 0, 600, 400);

        // Center line
        ctx.setLineDash([8, 8]);
        ctx.strokeStyle = 'rgba(244,63,94,0.3)';
        ctx.beginPath(); ctx.moveTo(300, 0); ctx.lineTo(300, 400); ctx.stroke();
        ctx.setLineDash([]);

        // Ball glow trail
        ball.trail.forEach((t, i) => {
          const alpha = i / ball.trail.length * 0.4;
          ctx.beginPath();
          ctx.arc(t.x, t.y, ball.r * (i / ball.trail.length), 0, Math.PI * 2);
          ctx.fillStyle = `hsla(${hue}, 100%, 60%, ${alpha})`;
          ctx.fill();
        });

        // Ball with glow
        ctx.shadowBlur = 25;
        ctx.shadowColor = `hsl(${hue}, 100%, 60%)`;
        ctx.beginPath();
        ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI * 2);
        ctx.fillStyle = `hsl(${hue}, 100%, 70%)`;
        ctx.fill();
        ctx.shadowBlur = 0;

        // Paddles with glow
        ctx.shadowBlur = 15;
        ctx.shadowColor = player.color;
        ctx.fillStyle = player.color;
        ctx.beginPath();
        ctx.roundRect(player.x, player.y, player.w, player.h, 7);
        ctx.fill();

        ctx.shadowColor = ai.color;
        ctx.fillStyle = ai.color;
        ctx.beginPath();
        ctx.roundRect(ai.x, ai.y, ai.w, ai.h, 7);
        ctx.fill();
        ctx.shadowBlur = 0;

        // Particles
        particles.forEach(p => {
          ctx.globalAlpha = p.life;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
        });
        ctx.globalAlpha = 1;

        update();
        if (running) requestAnimationFrame(draw);
      }
      draw();
    }

    // -------- 2. NAUGHTY SNAKE - Canvas snake game --------
    function renderNaughtySnake(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#0a1628,#1e3a5f);border:2px solid #10b981;">
          <h3 class="text-2xl font-bold text-emerald-400 mb-2">ğŸ Naughty Snake</h3>
          <p class="text-emerald-200 text-sm mb-3">Eat the ğŸ‘ peaches and ğŸ† eggplants! Don't hit yourself ğŸ”</p>
          <canvas id="nsCanvas" width="400" height="400" style="border:2px solid #10b981;border-radius:16px;max-width:100%;background:#050d1a;display:block;margin:0 auto;"></canvas>
          <div class="mt-3 flex justify-center gap-4 items-center">
            <span class="text-emerald-300 text-sm">Score: <strong class="text-2xl text-emerald-400" id="nsScore">0</strong></span>
            <span class="text-emerald-300 text-sm">Best: <strong class="text-emerald-400" id="nsBest">0</strong></span>
          </div>
          <p class="text-emerald-300 text-xs mt-2" id="nsStatus">Arrow keys / Swipe to move</p>
          <div class="flex justify-center gap-2 mt-3 md:hidden">
            <button onclick="nsDir('up')" class="bg-emerald-700 text-white px-4 py-2 rounded-lg text-xl">â¬†ï¸</button>
          </div>
          <div class="flex justify-center gap-2 mt-1 md:hidden">
            <button onclick="nsDir('left')" class="bg-emerald-700 text-white px-4 py-2 rounded-lg text-xl">â¬…ï¸</button>
            <button onclick="nsDir('down')" class="bg-emerald-700 text-white px-4 py-2 rounded-lg text-xl">â¬‡ï¸</button>
            <button onclick="nsDir('right')" class="bg-emerald-700 text-white px-4 py-2 rounded-lg text-xl">â¡ï¸</button>
          </div>
        </div>`;

      const canvas = document.getElementById('nsCanvas');
      const ctx = canvas.getContext('2d');
      const grid = 20;
      const cols = 20, rows = 20;
      let snake = [{ x: 10, y: 10 }];
      let dir = { x: 1, y: 0 };
      let nextDir = { x: 1, y: 0 };
      let food = spawnFood();
      let score = 0;
      let best = parseInt(localStorage.getItem('ns_best') || '0');
      let running = true;
      let particles = [];
      const foodEmojis = ['ğŸ‘', 'ğŸ†', 'ğŸ’‹', 'ğŸ”¥', 'ğŸ‘…', 'ğŸ’¦'];
      let currentEmoji = foodEmojis[0];
      document.getElementById('nsBest').textContent = best;

      function spawnFood() {
        let f;
        do {
          f = { x: Math.floor(Math.random() * cols), y: Math.floor(Math.random() * rows) };
        } while (snake.some(s => s.x === f.x && s.y === f.y));
        currentEmoji = foodEmojis[Math.floor(Math.random() * foodEmojis.length)];
        return f;
      }

      window.nsDir = function(d) {
        const dirs = { up: { x: 0, y: -1 }, down: { x: 0, y: 1 }, left: { x: -1, y: 0 }, right: { x: 1, y: 0 } };
        const nd = dirs[d];
        if (nd && !(nd.x === -dir.x && nd.y === -dir.y)) nextDir = nd;
      };

      document.addEventListener('keydown', e => {
        const map = { ArrowUp: 'up', ArrowDown: 'down', ArrowLeft: 'left', ArrowRight: 'right', w: 'up', s: 'down', a: 'left', d: 'right' };
        if (map[e.key]) { e.preventDefault(); window.nsDir(map[e.key]); }
      });

      function spawnEatParticles(x, y) {
        for (let i = 0; i < 12; i++) {
          particles.push({
            x: x * grid + grid / 2, y: y * grid + grid / 2,
            vx: (Math.random() - 0.5) * 8, vy: (Math.random() - 0.5) * 8,
            life: 1, color: ['#10b981', '#f43f5e', '#fbbf24', '#ec4899'][Math.floor(Math.random() * 4)],
            size: 3 + Math.random() * 4
          });
        }
      }

      function gameLoop() {
        if (!running) return;
        dir = nextDir;
        const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

        // Wall wrap
        if (head.x < 0) head.x = cols - 1;
        if (head.x >= cols) head.x = 0;
        if (head.y < 0) head.y = rows - 1;
        if (head.y >= rows) head.y = 0;

        // Self collision
        if (snake.some(s => s.x === head.x && s.y === head.y)) {
          running = false;
          screenShake(10, 400);
          if (score > best) { best = score; localStorage.setItem('ns_best', best); }
          document.getElementById('nsStatus').textContent = `ğŸ’€ Dead! Score: ${score}`;
          document.getElementById('nsBest').textContent = best;
          postScore('naughty_snake', score);
          if (score >= 50) launchConfetti(80);
          return;
        }

        snake.unshift(head);

        if (head.x === food.x && head.y === food.y) {
          score += 10;
          document.getElementById('nsScore').textContent = score;
          spawnEatParticles(food.x, food.y);
          food = spawnFood();
        } else {
          snake.pop();
        }

        // Draw
        ctx.fillStyle = '#050d1a';
        ctx.fillRect(0, 0, 400, 400);

        // Grid lines
        ctx.strokeStyle = 'rgba(16,185,129,0.05)';
        for (let i = 0; i < cols; i++) {
          ctx.beginPath(); ctx.moveTo(i * grid, 0); ctx.lineTo(i * grid, 400); ctx.stroke();
          ctx.beginPath(); ctx.moveTo(0, i * grid); ctx.lineTo(400, i * grid); ctx.stroke();
        }

        // Snake body with gradient
        snake.forEach((s, i) => {
          const ratio = 1 - i / snake.length;
          const r = Math.floor(16 + ratio * 0);
          const g = Math.floor(185 - ratio * 60);
          const b = Math.floor(129 + ratio * 50);
          ctx.shadowBlur = i === 0 ? 15 : 5;
          ctx.shadowColor = i === 0 ? '#10b981' : 'transparent';
          ctx.fillStyle = `rgb(${r},${g},${b})`;
          ctx.beginPath();
          ctx.roundRect(s.x * grid + 1, s.y * grid + 1, grid - 2, grid - 2, 4);
          ctx.fill();
          if (i === 0) {
            // Eyes
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(s.x * grid + 7, s.y * grid + 7, 3, 0, Math.PI * 2);
            ctx.arc(s.x * grid + 14, s.y * grid + 7, 3, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#000';
            ctx.beginPath();
            ctx.arc(s.x * grid + 7 + dir.x, s.y * grid + 7 + dir.y, 1.5, 0, Math.PI * 2);
            ctx.arc(s.x * grid + 14 + dir.x, s.y * grid + 7 + dir.y, 1.5, 0, Math.PI * 2);
            ctx.fill();
          }
        });
        ctx.shadowBlur = 0;

        // Food with pulse glow
        const pulse = Math.sin(Date.now() / 200) * 0.3 + 0.7;
        ctx.shadowBlur = 15 * pulse;
        ctx.shadowColor = '#f43f5e';
        ctx.font = `${14 + pulse * 4}px serif`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(currentEmoji, food.x * grid + grid / 2, food.y * grid + grid / 2);
        ctx.shadowBlur = 0;

        // Particles
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.04; p.vy += 0.15;
          ctx.globalAlpha = p.life;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
          return p.life > 0;
        });
        ctx.globalAlpha = 1;

        setTimeout(gameLoop, Math.max(100, 200 - score * 1.5));
      }
      setTimeout(gameLoop, 500);
    }

    // -------- 3. KISS CATCHER - Falling objects canvas game --------
    function renderKissCatcher(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#2d0a2e,#5c1a5e);border:2px solid #ec4899;">
          <h3 class="text-2xl font-bold text-pink-400 mb-2">ğŸ’‹ Kiss Catcher</h3>
          <p class="text-pink-200 text-sm mb-3">Catch the kisses ğŸ’‹, dodge the ğŸ’” heartbreaks! 30 seconds ğŸ”</p>
          <canvas id="kcCanvas" width="500" height="400" style="border:2px solid #ec4899;border-radius:16px;max-width:100%;background:#1a0520;display:block;margin:0 auto;cursor:none;"></canvas>
          <div class="mt-3 flex justify-center gap-6">
            <span class="text-pink-300 text-sm">Score: <strong class="text-2xl text-pink-400" id="kcScore">0</strong></span>
            <span class="text-pink-300 text-sm">Time: <strong class="text-xl text-pink-400" id="kcTime">30</strong>s</span>
          </div>
        </div>`;

      const canvas = document.getElementById('kcCanvas');
      const ctx = canvas.getContext('2d');
      let score = 0, timeLeft = 30;
      let catcher = { x: 250, y: 360, w: 60, h: 30 };
      let items = [];
      let particles = [];
      let hearts = [];
      let running = true;

      canvas.addEventListener('mousemove', e => {
        const r = canvas.getBoundingClientRect();
        catcher.x = ((e.clientX - r.left) / r.width) * 500 - catcher.w / 2;
        catcher.x = Math.max(0, Math.min(500 - catcher.w, catcher.x));
      });
      canvas.addEventListener('touchmove', e => {
        e.preventDefault();
        const r = canvas.getBoundingClientRect();
        catcher.x = ((e.touches[0].clientX - r.left) / r.width) * 500 - catcher.w / 2;
        catcher.x = Math.max(0, Math.min(500 - catcher.w, catcher.x));
      }, { passive: false });

      const types = [
        { emoji: 'ğŸ’‹', points: 10, good: true },
        { emoji: 'ğŸ‘', points: 15, good: true },
        { emoji: 'ğŸ’¦', points: 20, good: true },
        { emoji: 'ğŸ”¥', points: 25, good: true },
        { emoji: 'ğŸ’”', points: -15, good: false },
        { emoji: 'ğŸ¤®', points: -20, good: false },
      ];

      function spawnItem() {
        if (!running) return;
        const t = types[Math.floor(Math.random() * types.length)];
        items.push({ ...t, x: Math.random() * 460 + 20, y: -20, vy: 1.2 + Math.random() * 1.5, size: 24, rot: 0, rotV: (Math.random() - 0.5) * 0.1 });
      }

      function spawnCatchParticles(x, y, good) {
        const colors = good ? ['#ec4899', '#f43f5e', '#fbbf24'] : ['#6b7280', '#374151'];
        for (let i = 0; i < 10; i++) {
          particles.push({
            x, y, vx: (Math.random() - 0.5) * 8, vy: -Math.random() * 6,
            life: 1, color: colors[Math.floor(Math.random() * colors.length)],
            size: 3 + Math.random() * 4
          });
        }
        if (good) {
          hearts.push({ x, y, life: 1, size: 20 });
        }
      }

      const timer = setInterval(() => {
        timeLeft--;
        document.getElementById('kcTime').textContent = timeLeft;
        if (timeLeft <= 0) {
          running = false;
          clearInterval(timer);
          clearInterval(spawner);
          const finalScore = Math.max(0, score);
          document.getElementById('kcScore').textContent = finalScore;
          if (finalScore >= 100) launchConfetti(100);
          postScore('kiss_catcher', finalScore);
        }
      }, 1000);

      const spawner = setInterval(spawnItem, 800);

      function draw() {
        if (!running && items.length === 0) return;
        ctx.fillStyle = '#1a0520';
        ctx.fillRect(0, 0, 500, 400);

        // Starfield background
        for (let i = 0; i < 30; i++) {
          const sx = (i * 127 + Date.now() / 50) % 500;
          const sy = (i * 89 + Date.now() / 80) % 400;
          ctx.fillStyle = `rgba(236,72,153,${0.1 + Math.sin(Date.now() / 500 + i) * 0.1})`;
          ctx.beginPath();
          ctx.arc(sx, sy, 1.5, 0, Math.PI * 2);
          ctx.fill();
        }

        // Catcher (mouth shape)
        ctx.save();
        ctx.translate(catcher.x + catcher.w / 2, catcher.y + catcher.h / 2);
        ctx.shadowBlur = 20;
        ctx.shadowColor = '#ec4899';
        ctx.fillStyle = '#ec4899';
        ctx.beginPath();
        ctx.ellipse(0, 0, catcher.w / 2, catcher.h / 2, 0, 0, Math.PI);
        ctx.fill();
        ctx.fillStyle = '#be185d';
        ctx.beginPath();
        ctx.ellipse(0, -5, catcher.w / 2 - 5, catcher.h / 2 - 5, 0, Math.PI, Math.PI * 2);
        ctx.fill();
        ctx.shadowBlur = 0;
        ctx.restore();

        // Items
        items = items.filter(item => {
          item.y += item.vy;
          item.rot += item.rotV;

          // Catch check
          if (item.y + item.size > catcher.y && item.y < catcher.y + catcher.h &&
              item.x > catcher.x && item.x < catcher.x + catcher.w) {
            score += item.points;
            document.getElementById('kcScore').textContent = Math.max(0, score);
            spawnCatchParticles(item.x, item.y, item.good);
            if (!item.good) screenShake(5, 200);
            return false;
          }

          if (item.y > 420) return false;

          ctx.save();
          ctx.translate(item.x, item.y);
          ctx.rotate(item.rot);
          ctx.font = `${item.size}px serif`;
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.shadowBlur = item.good ? 10 : 0;
          ctx.shadowColor = '#ec4899';
          ctx.fillText(item.emoji, 0, 0);
          ctx.restore();
          return true;
        });

        // Particles
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.03; p.vy += 0.15;
          ctx.globalAlpha = p.life;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
          return p.life > 0;
        });

        // Floating hearts
        hearts = hearts.filter(h => {
          h.y -= 1.5; h.life -= 0.02;
          ctx.globalAlpha = h.life;
          ctx.font = `${h.size}px serif`;
          ctx.textAlign = 'center';
          ctx.fillText('â¤ï¸', h.x, h.y);
          return h.life > 0;
        });
        ctx.globalAlpha = 1;

        requestAnimationFrame(draw);
      }
      draw();
    }

    // -------- 4. SPANK-A-MOLE - Whack-a-mole variant --------
    function renderSpankMole(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#2d1a00,#6b3a00);border:2px solid #f59e0b;">
          <h3 class="text-2xl font-bold text-amber-400 mb-2">ğŸ‘ Spank-a-Mole</h3>
          <p class="text-amber-200 text-sm mb-3">Spank the peaches before they hide! 25 seconds ğŸ”</p>
          <canvas id="smCanvas" width="450" height="400" style="border:2px solid #f59e0b;border-radius:16px;max-width:100%;background:#1a0e00;display:block;margin:0 auto;cursor:pointer;"></canvas>
          <div class="mt-3 flex justify-center gap-6">
            <span class="text-amber-300 text-sm">Score: <strong class="text-2xl text-amber-400" id="smScore">0</strong></span>
            <span class="text-amber-300 text-sm">Time: <strong class="text-xl text-amber-400" id="smTime">25</strong>s</span>
            <span class="text-amber-300 text-sm">Streak: <strong class="text-xl text-red-400" id="smStreak">0</strong>ğŸ”¥</span>
          </div>
        </div>`;

      const canvas = document.getElementById('smCanvas');
      const ctx = canvas.getContext('2d');
      let score = 0, timeLeft = 25, streak = 0;
      let running = true;
      const holes = [];
      const cols = 3, rows = 3;
      const holeW = 120, holeH = 100;
      let particles = [];
      let handX = 0, handY = 0;

      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          holes.push({
            x: c * 150 + 30, y: r * 130 + 15,
            active: false, timer: 0, hit: false,
            emoji: 'ğŸ‘', shake: 0, scale: 0
          });
        }
      }

      canvas.addEventListener('mousemove', e => {
        const r = canvas.getBoundingClientRect();
        handX = ((e.clientX - r.left) / r.width) * 450;
        handY = ((e.clientY - r.top) / r.height) * 400;
      });

      canvas.addEventListener('click', e => {
        if (!running) return;
        const r = canvas.getBoundingClientRect();
        const mx = ((e.clientX - r.left) / r.width) * 450;
        const my = ((e.clientY - r.top) / r.height) * 400;

        holes.forEach(hole => {
          if (hole.active && !hole.hit) {
            const cx = hole.x + holeW / 2;
            const cy = hole.y + holeH / 2;
            if (Math.abs(mx - cx) < holeW / 2 && Math.abs(my - cy) < holeH / 2) {
              hole.hit = true;
              hole.shake = 10;
              streak++;
              const bonus = Math.min(streak, 5);
              const pts = 10 + bonus * 2;
              score += pts;
              document.getElementById('smScore').textContent = score;
              document.getElementById('smStreak').textContent = streak;

              // Spank particles!
              for (let i = 0; i < 20; i++) {
                particles.push({
                  x: cx, y: cy,
                  vx: (Math.random() - 0.5) * 12, vy: (Math.random() - 0.5) * 12 - 3,
                  life: 1, color: ['#f59e0b', '#ef4444', '#ec4899', '#fbbf24'][Math.floor(Math.random() * 4)],
                  size: 4 + Math.random() * 6, text: ['ğŸ‘‹', 'ğŸ’¥', 'ğŸ”¥', 'âœ¨'][Math.floor(Math.random() * 4)]
                });
              }
              screenShake(4, 150);
              floatScore(`+${pts}`, e.clientX, e.clientY, '#f59e0b');
            }
          }
        });
      });

      canvas.addEventListener('touchstart', e => {
        e.preventDefault();
        const touch = e.touches[0];
        canvas.dispatchEvent(new MouseEvent('click', { clientX: touch.clientX, clientY: touch.clientY }));
      }, { passive: false });

      function popMole() {
        if (!running) return;
        const available = holes.filter(h => !h.active);
        if (available.length === 0) return;
        const hole = available[Math.floor(Math.random() * available.length)];
        hole.active = true;
        hole.hit = false;
        hole.scale = 0;
        hole.emoji = ['ğŸ‘', 'ğŸ‘', 'ğŸ‘', 'ğŸ†', 'ğŸ’‹', 'ğŸ”¥'][Math.floor(Math.random() * 6)];
        hole.timer = setTimeout(() => {
          if (!hole.hit) streak = 0;
          hole.active = false;
          document.getElementById('smStreak').textContent = streak;
        }, 1800 - Math.min(score * 3, 800));
      }

      const spawner = setInterval(popMole, 900 - Math.min(score * 2, 400));
      const timer = setInterval(() => {
        timeLeft--;
        document.getElementById('smTime').textContent = timeLeft;
        if (timeLeft <= 0) {
          running = false; clearInterval(timer); clearInterval(spawner);
          if (score >= 80) launchConfetti(100);
          postScore('spank_mole', score);
        }
      }, 1000);

      function draw() {
        ctx.fillStyle = '#1a0e00';
        ctx.fillRect(0, 0, 450, 400);

        // Draw holes
        holes.forEach(hole => {
          // Hole shadow
          ctx.fillStyle = '#0d0700';
          ctx.beginPath();
          ctx.ellipse(hole.x + holeW / 2, hole.y + holeH - 10, holeW / 2 - 5, 18, 0, 0, Math.PI * 2);
          ctx.fill();

          // Hole border glow
          ctx.strokeStyle = hole.active ? '#f59e0b' : '#4a3000';
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.ellipse(hole.x + holeW / 2, hole.y + holeH - 10, holeW / 2 - 5, 18, 0, 0, Math.PI * 2);
          ctx.stroke();

          if (hole.active) {
            // Animate scale in
            if (hole.scale < 1) hole.scale += 0.15;

            const shakeX = hole.shake > 0 ? (Math.random() - 0.5) * hole.shake : 0;
            hole.shake *= 0.8;

            ctx.save();
            ctx.translate(hole.x + holeW / 2 + shakeX, hole.y + holeH / 2);
            ctx.scale(hole.scale, hole.scale);

            // Glow
            ctx.shadowBlur = 20;
            ctx.shadowColor = hole.hit ? '#ef4444' : '#f59e0b';

            ctx.font = `${hole.hit ? 30 : 44}px serif`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(hole.hit ? 'ğŸ’¥' : hole.emoji, 0, 0);

            ctx.shadowBlur = 0;
            ctx.restore();
          }
        });

        // Particles
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.03; p.vy += 0.2;
          ctx.globalAlpha = p.life;
          if (p.text) {
            ctx.font = `${p.size * 2}px serif`;
            ctx.textAlign = 'center';
            ctx.fillText(p.text, p.x, p.y);
          } else {
            ctx.fillStyle = p.color;
            ctx.beginPath();
            ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
            ctx.fill();
          }
          return p.life > 0;
        });
        ctx.globalAlpha = 1;

        // Custom cursor hand
        ctx.font = '30px serif';
        ctx.textAlign = 'center';
        ctx.fillText('ğŸ‘‹', handX, handY);

        if (running || particles.length > 0) requestAnimationFrame(draw);
        else {
          ctx.fillStyle = 'rgba(0,0,0,0.7)';
          ctx.fillRect(0, 0, 450, 400);
          ctx.fillStyle = '#f59e0b';
          ctx.font = 'bold 36px sans-serif';
          ctx.textAlign = 'center';
          ctx.fillText(`ğŸ‘ Final Score: ${score}`, 225, 180);
          ctx.font = '20px sans-serif';
          ctx.fillStyle = '#fbbf24';
          ctx.fillText(score >= 100 ? 'ğŸ”¥ SPANK MASTER!' : score >= 60 ? 'ğŸ‘‹ Nice spanking!' : 'ğŸ˜… Weak slaps...', 225, 230);
        }
      }
      draw();
    }

    // -------- 5. BODY SHOTS - Target shooting canvas game --------
    function renderBodyShots(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#1a002d,#3d0066);border:2px solid #a855f7;">
          <h3 class="text-2xl font-bold text-purple-400 mb-2">ğŸ¯ Body Shots</h3>
          <p class="text-purple-200 text-sm mb-3">Shoot the targets before they escape! 20 rounds ğŸ”</p>
          <canvas id="bsCanvas" width="500" height="400" style="border:2px solid #a855f7;border-radius:16px;max-width:100%;background:#0d0019;display:block;margin:0 auto;cursor:crosshair;"></canvas>
          <div class="mt-3 flex justify-center gap-6">
            <span class="text-purple-300 text-sm">Score: <strong class="text-2xl text-purple-400" id="bsScore">0</strong></span>
            <span class="text-purple-300 text-sm">Shots: <strong class="text-xl text-purple-400" id="bsShots">20</strong></span>
            <span class="text-purple-300 text-sm">Combo: <strong class="text-xl text-yellow-400" id="bsCombo">0</strong>x</span>
          </div>
        </div>`;

      const canvas = document.getElementById('bsCanvas');
      const ctx = canvas.getContext('2d');
      let score = 0, shotsLeft = 20, combo = 0;
      let targets = [];
      let explosions = [];
      let crosshair = { x: 250, y: 200 };
      let running = true;
      let hue = 0;

      canvas.addEventListener('mousemove', e => {
        const r = canvas.getBoundingClientRect();
        crosshair.x = ((e.clientX - r.left) / r.width) * 500;
        crosshair.y = ((e.clientY - r.top) / r.height) * 400;
      });

      function spawnTarget() {
        const emojis = ['ğŸ‘', 'ğŸ†', 'ğŸ’‹', 'ğŸ‘…', 'ğŸ”¥', 'ğŸ’¦', 'ğŸ˜ˆ'];
        targets.push({
          x: 50 + Math.random() * 400,
          y: 50 + Math.random() * 300,
          r: 25 + Math.random() * 20,
          vx: (Math.random() - 0.5) * 2.5,
          vy: (Math.random() - 0.5) * 2.5,
          emoji: emojis[Math.floor(Math.random() * emojis.length)],
          life: 100 + Math.random() * 80,
          pulse: 0, points: 10
        });
      }

      for (let i = 0; i < 3; i++) spawnTarget();

      canvas.addEventListener('click', e => {
        if (!running || shotsLeft <= 0) return;
        shotsLeft--;
        document.getElementById('bsShots').textContent = shotsLeft;

        // Muzzle flash
        explosions.push({ x: crosshair.x, y: crosshair.y, r: 30, life: 1 });
        screenShake(2, 100);

        let hit = false;
        targets = targets.filter(t => {
          const dx = crosshair.x - t.x;
          const dy = crosshair.y - t.y;
          if (Math.sqrt(dx * dx + dy * dy) < t.r) {
            hit = true;
            combo++;
            const pts = t.points * Math.min(combo, 5);
            score += pts;
            document.getElementById('bsScore').textContent = score;
            document.getElementById('bsCombo').textContent = combo;
            floatScore(`+${pts}`, e.clientX, e.clientY, '#a855f7');

            // Explosion particles
            for (let j = 0; j < 20; j++) {
              explosions.push({
                x: t.x, y: t.y, r: 3 + Math.random() * 5,
                vx: (Math.random() - 0.5) * 12, vy: (Math.random() - 0.5) * 12,
                life: 1, color: ['#a855f7', '#ec4899', '#fbbf24', '#f43f5e'][Math.floor(Math.random() * 4)]
              });
            }
            spawnTarget();
            return false;
          }
          return true;
        });

        if (!hit) {
          combo = 0;
          document.getElementById('bsCombo').textContent = 0;
        }

        if (shotsLeft <= 0) {
          running = false;
          if (score >= 100) launchConfetti(80);
          postScore('body_shots', score);
        }
      });

      canvas.addEventListener('touchstart', e => {
        e.preventDefault();
        const r = canvas.getBoundingClientRect();
        crosshair.x = ((e.touches[0].clientX - r.left) / r.width) * 500;
        crosshair.y = ((e.touches[0].clientY - r.top) / r.height) * 400;
        canvas.dispatchEvent(new MouseEvent('click', { clientX: e.touches[0].clientX, clientY: e.touches[0].clientY }));
      }, { passive: false });

      function draw() {
        hue = (hue + 0.3) % 360;
        ctx.fillStyle = '#0d0019';
        ctx.fillRect(0, 0, 500, 400);

        // Background neon grid
        ctx.strokeStyle = `hsla(${hue}, 80%, 30%, 0.1)`;
        ctx.lineWidth = 1;
        for (let i = 0; i < 500; i += 40) {
          ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, 400); ctx.stroke();
        }
        for (let i = 0; i < 400; i += 40) {
          ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(500, i); ctx.stroke();
        }

        // Targets
        targets.forEach(t => {
          t.x += t.vx; t.y += t.vy;
          t.pulse += 0.1;
          t.life--;

          // Bounce
          if (t.x < t.r || t.x > 500 - t.r) t.vx *= -1;
          if (t.y < t.r || t.y > 400 - t.r) t.vy *= -1;

          // Shrink when dying
          if (t.life < 30) t.r *= 0.98;
          if (t.life <= 0) {
            spawnTarget();
            return;
          }

          // Target ring glow
          const pulseScale = 1 + Math.sin(t.pulse) * 0.1;
          ctx.save();
          ctx.translate(t.x, t.y);
          ctx.scale(pulseScale, pulseScale);
          ctx.shadowBlur = 20;
          ctx.shadowColor = '#a855f7';
          ctx.strokeStyle = `hsla(${hue + 60}, 80%, 60%, 0.6)`;
          ctx.lineWidth = 2;
          ctx.beginPath();
          ctx.arc(0, 0, t.r, 0, Math.PI * 2);
          ctx.stroke();
          ctx.beginPath();
          ctx.arc(0, 0, t.r * 0.6, 0, Math.PI * 2);
          ctx.stroke();

          ctx.font = `${t.r}px serif`;
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(t.emoji, 0, 2);
          ctx.shadowBlur = 0;
          ctx.restore();
        });

        // Explosions / particles
        explosions = explosions.filter(e => {
          if (e.vx !== undefined) {
            e.x += e.vx; e.y += e.vy; e.life -= 0.03; e.vy += 0.1;
            ctx.globalAlpha = e.life;
            ctx.fillStyle = e.color || '#a855f7';
            ctx.beginPath();
            ctx.arc(e.x, e.y, e.r * e.life, 0, Math.PI * 2);
            ctx.fill();
          } else {
            e.life -= 0.08;
            ctx.globalAlpha = e.life;
            ctx.fillStyle = '#fff';
            ctx.beginPath();
            ctx.arc(e.x, e.y, e.r * (1 - e.life), 0, Math.PI * 2);
            ctx.fill();
          }
          return e.life > 0;
        });
        ctx.globalAlpha = 1;

        // Crosshair
        ctx.strokeStyle = `hsl(${hue}, 100%, 60%)`;
        ctx.lineWidth = 2;
        ctx.shadowBlur = 10;
        ctx.shadowColor = `hsl(${hue}, 100%, 60%)`;
        ctx.beginPath();
        ctx.arc(crosshair.x, crosshair.y, 18, 0, Math.PI * 2);
        ctx.stroke();
        ctx.beginPath();
        ctx.moveTo(crosshair.x - 25, crosshair.y);
        ctx.lineTo(crosshair.x - 10, crosshair.y);
        ctx.moveTo(crosshair.x + 10, crosshair.y);
        ctx.lineTo(crosshair.x + 25, crosshair.y);
        ctx.moveTo(crosshair.x, crosshair.y - 25);
        ctx.lineTo(crosshair.x, crosshair.y - 10);
        ctx.moveTo(crosshair.x, crosshair.y + 10);
        ctx.lineTo(crosshair.x, crosshair.y + 25);
        ctx.stroke();
        ctx.shadowBlur = 0;
        // Center dot
        ctx.fillStyle = '#f43f5e';
        ctx.beginPath();
        ctx.arc(crosshair.x, crosshair.y, 2, 0, Math.PI * 2);
        ctx.fill();

        if (running) requestAnimationFrame(draw);
        else {
          ctx.fillStyle = 'rgba(0,0,0,0.75)';
          ctx.fillRect(0, 0, 500, 400);
          ctx.fillStyle = '#a855f7';
          ctx.font = 'bold 36px sans-serif';
          ctx.textAlign = 'center';
          ctx.fillText(`ğŸ¯ Score: ${score}`, 250, 180);
          ctx.fillStyle = '#c084fc';
          ctx.font = '20px sans-serif';
          ctx.fillText(score >= 150 ? 'ğŸ”¥ SHARPSHOOTER!' : score >= 80 ? 'ğŸ˜ Nice aim!' : 'ğŸ˜µ Missed most shots...', 250, 225);
        }
      }
      draw();
    }

    // -------- 6. TWERK RUNNER - Endless runner canvas game --------
    function renderTwerkRunner(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#1a002e,#4a0080);border:2px solid #d946ef;">
          <h3 class="text-2xl font-bold text-fuchsia-400 mb-2">ğŸƒ Twerk Runner</h3>
          <p class="text-fuchsia-200 text-sm mb-3">Jump & dodge! Tap/Space to jump, collect ğŸ‘! ğŸ”</p>
          <canvas id="trCanvas" width="600" height="300" style="border:2px solid #d946ef;border-radius:16px;max-width:100%;background:#0a0015;display:block;margin:0 auto;"></canvas>
          <div class="mt-3 flex justify-center gap-6">
            <span class="text-fuchsia-300 text-sm">Score: <strong class="text-2xl text-fuchsia-400" id="trScore">0</strong></span>
            <span class="text-fuchsia-300 text-sm">Distance: <strong class="text-xl text-fuchsia-400" id="trDist">0</strong>m</span>
          </div>
        </div>`;

      const canvas = document.getElementById('trCanvas');
      const ctx = canvas.getContext('2d');
      let score = 0, distance = 0, speed = 4;
      let running = true;
      const player = { x: 80, y: 230, w: 35, h: 45, vy: 0, jumping: false, frame: 0, twerk: 0 };
      let obstacles = [];
      let collectibles = [];
      let particles = [];
      let groundOffset = 0;
      let bgStars = [];

      // Generate stars
      for (let i = 0; i < 60; i++) {
        bgStars.push({ x: Math.random() * 600, y: Math.random() * 200, size: Math.random() * 2 + 0.5, speed: Math.random() * 0.5 + 0.2 });
      }

      function jump() {
        if (!player.jumping && running) {
          player.vy = -12;
          player.jumping = true;
          player.twerk = 5;
        }
      }

      document.addEventListener('keydown', e => { if (e.code === 'Space' || e.key === 'ArrowUp') { e.preventDefault(); jump(); } });
      canvas.addEventListener('click', jump);
      canvas.addEventListener('touchstart', e => { e.preventDefault(); jump(); }, { passive: false });

      function spawnObstacle() {
        const types = [
          { w: 30, h: 50, emoji: 'ğŸš«', color: '#ef4444' },
          { w: 40, h: 35, emoji: 'ğŸ’”', color: '#f43f5e' },
          { w: 25, h: 60, emoji: 'ğŸ¤®', color: '#6b7280' },
        ];
        const t = types[Math.floor(Math.random() * types.length)];
        obstacles.push({ x: 620, y: 270 - t.h, ...t });
      }

      function spawnCollectible() {
        const y = 150 + Math.random() * 80;
        collectibles.push({ x: 620, y, emoji: ['ğŸ‘', 'ğŸ’‹', 'ğŸ’¦', 'ğŸ”¥', 'ğŸ†'][Math.floor(Math.random() * 5)], r: 15, pulse: 0 });
      }

      let frameCount = 0;

      function update() {
        if (!running) return;
        frameCount++;
        distance++;
        speed = 2.5 + distance / 1000;
        groundOffset = (groundOffset + speed) % 40;

        if (frameCount % Math.max(60, 120 - Math.floor(distance / 50)) === 0) spawnObstacle();
        if (frameCount % 60 === 0) spawnCollectible();

        // Player physics
        player.vy += 0.7;
        player.y += player.vy;
        if (player.y >= 230) { player.y = 230; player.jumping = false; player.vy = 0; }
        player.frame += 0.15;
        if (player.twerk > 0) player.twerk -= 0.2;

        // Move obstacles
        obstacles = obstacles.filter(o => {
          o.x -= speed;
          // Collision
          if (player.x + player.w > o.x + 5 && player.x < o.x + o.w - 5 &&
              player.y + player.h > o.y + 5) {
            running = false;
            screenShake(10, 400);
            for (let i = 0; i < 25; i++) {
              particles.push({
                x: player.x + player.w / 2, y: player.y + player.h / 2,
                vx: (Math.random() - 0.5) * 10, vy: (Math.random() - 0.5) * 10,
                life: 1, color: ['#ef4444', '#f43f5e', '#fbbf24'][Math.floor(Math.random() * 3)],
                size: 4 + Math.random() * 6
              });
            }
            const finalScore = Math.floor(distance / 10) + score;
            document.getElementById('trScore').textContent = finalScore;
            if (finalScore >= 80) launchConfetti(80);
            postScore('twerk_runner', finalScore);
          }
          return o.x > -50;
        });

        // Move collectibles
        collectibles = collectibles.filter(c => {
          c.x -= speed;
          c.pulse += 0.1;
          const dx = (player.x + player.w / 2) - c.x;
          const dy = (player.y + player.h / 2) - c.y;
          if (Math.sqrt(dx * dx + dy * dy) < c.r + 20) {
            score += 15;
            document.getElementById('trScore').textContent = score + Math.floor(distance / 10);
            for (let i = 0; i < 8; i++) {
              particles.push({
                x: c.x, y: c.y, vx: (Math.random() - 0.5) * 6, vy: -Math.random() * 4,
                life: 1, color: '#ec4899', size: 3 + Math.random() * 3
              });
            }
            return false;
          }
          return c.x > -20;
        });

        document.getElementById('trDist').textContent = Math.floor(distance / 10);
      }

      function draw() {
        ctx.fillStyle = '#0a0015';
        ctx.fillRect(0, 0, 600, 300);

        // Stars
        bgStars.forEach(s => {
          s.x -= s.speed;
          if (s.x < 0) s.x = 600;
          ctx.fillStyle = `rgba(217,70,239,${0.3 + Math.sin(Date.now() / 500 + s.x) * 0.2})`;
          ctx.beginPath();
          ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
          ctx.fill();
        });

        // Ground
        ctx.fillStyle = '#1e0030';
        ctx.fillRect(0, 270, 600, 30);
        ctx.strokeStyle = '#d946ef';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, 270);
        ctx.lineTo(600, 270);
        ctx.stroke();

        // Ground texture
        ctx.strokeStyle = 'rgba(217,70,239,0.2)';
        for (let i = -groundOffset; i < 600; i += 40) {
          ctx.beginPath(); ctx.moveTo(i, 275); ctx.lineTo(i + 20, 295); ctx.stroke();
        }

        // Player character (animated stick runner with twerk)
        ctx.save();
        ctx.translate(player.x + player.w / 2, player.y + player.h);
        const legAngle = Math.sin(player.frame) * 0.4;
        const twerkBounce = Math.sin(player.twerk * 3) * player.twerk;

        // Body glow
        ctx.shadowBlur = 15;
        ctx.shadowColor = '#d946ef';

        // Legs
        ctx.strokeStyle = '#d946ef';
        ctx.lineWidth = 4;
        ctx.beginPath();
        ctx.moveTo(0, -15);
        ctx.lineTo(-10 * Math.sin(legAngle), 0);
        ctx.moveTo(0, -15);
        ctx.lineTo(10 * Math.sin(legAngle), 0);
        ctx.stroke();

        // Body
        ctx.beginPath();
        ctx.moveTo(0, -15);
        ctx.lineTo(0 + twerkBounce, -35);
        ctx.stroke();

        // Butt (twerk effect)
        ctx.fillStyle = '#ec4899';
        ctx.beginPath();
        ctx.arc(twerkBounce * 0.5 - 5, -18 + Math.abs(twerkBounce) * 0.3, 8 + Math.abs(twerkBounce) * 0.5, 0, Math.PI * 2);
        ctx.fill();

        // Head
        ctx.fillStyle = '#d946ef';
        ctx.beginPath();
        ctx.arc(twerkBounce * 0.3, -42, 8, 0, Math.PI * 2);
        ctx.fill();

        // Arms
        ctx.strokeStyle = '#d946ef';
        ctx.beginPath();
        ctx.moveTo(0, -30);
        ctx.lineTo(-12 * Math.cos(player.frame * 0.8), -25 + Math.sin(player.frame) * 3);
        ctx.moveTo(0, -30);
        ctx.lineTo(12 * Math.cos(player.frame * 0.8), -25 - Math.sin(player.frame) * 3);
        ctx.stroke();

        ctx.shadowBlur = 0;
        ctx.restore();

        // Obstacles
        obstacles.forEach(o => {
          ctx.shadowBlur = 10;
          ctx.shadowColor = o.color;
          ctx.font = `${o.h * 0.7}px serif`;
          ctx.textAlign = 'center';
          ctx.textBaseline = 'bottom';
          ctx.fillText(o.emoji, o.x + o.w / 2, o.y + o.h);
          ctx.shadowBlur = 0;
        });

        // Collectibles
        collectibles.forEach(c => {
          const scale = 1 + Math.sin(c.pulse) * 0.15;
          ctx.save();
          ctx.translate(c.x, c.y);
          ctx.scale(scale, scale);
          ctx.shadowBlur = 15;
          ctx.shadowColor = '#ec4899';
          ctx.font = '22px serif';
          ctx.textAlign = 'center';
          ctx.textBaseline = 'middle';
          ctx.fillText(c.emoji, 0, 0);
          ctx.shadowBlur = 0;
          ctx.restore();
        });

        // Particles
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.03; p.vy += 0.1;
          ctx.globalAlpha = p.life;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
          return p.life > 0;
        });
        ctx.globalAlpha = 1;

        update();

        if (running) requestAnimationFrame(draw);
        else if (particles.length > 0) requestAnimationFrame(draw);
        else {
          ctx.fillStyle = 'rgba(0,0,0,0.75)';
          ctx.fillRect(0, 0, 600, 300);
          ctx.fillStyle = '#d946ef';
          ctx.font = 'bold 32px sans-serif';
          ctx.textAlign = 'center';
          const fs = Math.floor(distance / 10) + score;
          ctx.fillText(`ğŸƒ Distance: ${Math.floor(distance / 10)}m`, 300, 130);
          ctx.fillStyle = '#f0abfc';
          ctx.font = '22px sans-serif';
          ctx.fillText(`Score: ${fs}`, 300, 170);
          ctx.fillText(fs >= 100 ? 'ğŸ”¥ TWERK CHAMPION!' : fs >= 50 ? 'ğŸ‘ Nice moves!' : 'ğŸ˜… Keep practicing!', 300, 210);
        }
      }
      draw();
    }

    // -------- 7. STRIP POKER BLITZ - Quick card game --------
    function renderStripPoker(container) {
      const suits = ['â™ ï¸','â™¥ï¸','â™¦ï¸','â™£ï¸'];
      const values = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
      const deck = [];
      suits.forEach(s => values.forEach(v => deck.push({ suit: s, value: v, rank: values.indexOf(v) })));

      function shuffle(arr) { for (let i = arr.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [arr[i], arr[j]] = [arr[j], arr[i]]; } return arr; }
      shuffle(deck);

      let round = 0, playerWins = 0, aiWins = 0;
      const maxRounds = 10;
      let cardIdx = 0;
      let animating = false;

      container.innerHTML = `
        <div class="card rounded-3xl p-6 text-center bounce-in" style="background:linear-gradient(135deg,#0a2e0a,#1a5e1a);border:2px solid #f59e0b;">
          <h3 class="text-2xl font-bold text-yellow-400 mb-2">ğŸƒ Strip Poker Blitz</h3>
          <p class="text-yellow-200 text-sm mb-3">Higher card wins! Best of 10 rounds ğŸ”</p>
          <div class="flex justify-center gap-8 mb-4" style="min-height:180px;">
            <div class="text-center">
              <p class="text-green-300 text-sm mb-2">YOUR CARD</p>
              <div id="spkPlayerCard" style="width:100px;height:150px;background:linear-gradient(135deg,#1e3a1e,#2d5a2d);border:2px solid #4ade80;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:40px;color:#4ade80;box-shadow:0 0 20px rgba(74,222,128,0.3);transition:all 0.5s cubic-bezier(0.4,0,0.2,1);margin:0 auto;">?</div>
            </div>
            <div class="flex items-center text-3xl text-yellow-400 font-black" style="text-shadow:0 0 20px rgba(245,158,11,0.5);">VS</div>
            <div class="text-center">
              <p class="text-red-300 text-sm mb-2">AI CARD</p>
              <div id="spkAiCard" style="width:100px;height:150px;background:linear-gradient(135deg,#3a1e1e,#5a2d2d);border:2px solid #f43f5e;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:40px;color:#f43f5e;box-shadow:0 0 20px rgba(244,63,94,0.3);transition:all 0.5s cubic-bezier(0.4,0,0.2,1);margin:0 auto;">?</div>
            </div>
          </div>
          <div class="flex justify-center gap-6 mb-3">
            <span class="text-green-400">You: <strong id="spkPW">0</strong></span>
            <span class="text-gray-400">Round <strong id="spkRound">1</strong>/${maxRounds}</span>
            <span class="text-red-400">AI: <strong id="spkAW">0</strong></span>
          </div>
          <p class="text-yellow-300 text-sm mb-3" id="spkStatus">Click DRAW to play!</p>
          <button id="spkDrawBtn" class="bg-gradient-to-r from-yellow-500 to-amber-600 text-white font-bold px-8 py-3 rounded-full text-lg hover:scale-105 transition-transform shadow-lg shadow-yellow-500/30" style="animation:pulse-glow 2s infinite;">ğŸƒ DRAW CARD</button>
        </div>`;

      const playerCardEl = document.getElementById('spkPlayerCard');
      const aiCardEl = document.getElementById('spkAiCard');
      const drawBtn = document.getElementById('spkDrawBtn');

      drawBtn.onclick = () => {
        if (animating || round >= maxRounds) return;
        animating = true;
        round++;
        document.getElementById('spkRound').textContent = round;

        const pCard = deck[cardIdx++];
        const aCard = deck[cardIdx++];

        // Card flip animation
        playerCardEl.style.transform = 'rotateY(90deg)';
        aiCardEl.style.transform = 'rotateY(90deg)';

        setTimeout(() => {
          const redSuits = ['â™¥ï¸', 'â™¦ï¸'];
          playerCardEl.innerHTML = `<div style="text-align:center;"><div style="font-size:14px;">${pCard.suit}</div><div style="font-size:28px;font-weight:900;">${pCard.value}</div></div>`;
          playerCardEl.style.color = redSuits.includes(pCard.suit) ? '#f43f5e' : '#4ade80';
          playerCardEl.style.transform = 'rotateY(0deg)';

          aiCardEl.innerHTML = `<div style="text-align:center;"><div style="font-size:14px;">${aCard.suit}</div><div style="font-size:28px;font-weight:900;">${aCard.value}</div></div>`;
          aiCardEl.style.color = redSuits.includes(aCard.suit) ? '#f43f5e' : '#ef4444';
          aiCardEl.style.transform = 'rotateY(0deg)';

          setTimeout(() => {
            let result;
            if (pCard.rank > aCard.rank) {
              playerWins++;
              result = 'ğŸ˜ You win! AI strips!';
              playerCardEl.style.boxShadow = '0 0 40px rgba(74,222,128,0.6)';
              spawnParticles(playerCardEl.getBoundingClientRect().x + 50, playerCardEl.getBoundingClientRect().y + 75, 15, ['#4ade80', '#10b981']);
            } else if (aCard.rank > pCard.rank) {
              aiWins++;
              result = 'ğŸ˜ˆ AI wins! You strip!';
              aiCardEl.style.boxShadow = '0 0 40px rgba(244,63,94,0.6)';
              screenShake(4, 200);
            } else {
              result = 'ğŸ¤ Draw! Nobody strips';
            }

            document.getElementById('spkPW').textContent = playerWins;
            document.getElementById('spkAW').textContent = aiWins;
            document.getElementById('spkStatus').textContent = result;

            setTimeout(() => {
              playerCardEl.style.boxShadow = '0 0 20px rgba(74,222,128,0.3)';
              aiCardEl.style.boxShadow = '0 0 20px rgba(244,63,94,0.3)';
            }, 500);

            if (round >= maxRounds) {
              const score = playerWins * 10;
              drawBtn.textContent = playerWins > aiWins ? 'ğŸ‰ YOU WIN!' : aiWins > playerWins ? 'ğŸ˜ˆ AI WINS!' : 'ğŸ¤ DRAW!';
              drawBtn.disabled = true;
              if (playerWins > aiWins) launchConfetti(120);
              postScore('strip_poker', score);
            }

            animating = false;
          }, 400);
        }, 300);
      };
    }

    // -------- 8. NAUGHTY BLOCKS - Tetris-style canvas game --------
    function renderNaughtyBlocks(container) {
      container.innerHTML = `
        <div class="card rounded-3xl p-4 text-center bounce-in" style="background:linear-gradient(135deg,#001a2e,#003366);border:2px solid #06b6d4;">
          <h3 class="text-2xl font-bold text-cyan-400 mb-2">ğŸ§± Naughty Blocks</h3>
          <p class="text-cyan-200 text-sm mb-3">Stack the naughty blocks! Clear lines to score ğŸ”</p>
          <div class="flex justify-center gap-4">
            <canvas id="nbCanvas" width="250" height="500" style="border:2px solid #06b6d4;border-radius:12px;max-width:50%;background:#000a14;display:block;"></canvas>
            <div class="text-left">
              <p class="text-cyan-300 text-sm">Score</p>
              <p class="text-3xl font-black text-cyan-400" id="nbScore">0</p>
              <p class="text-cyan-300 text-sm mt-3">Level</p>
              <p class="text-2xl font-bold text-cyan-400" id="nbLevel">1</p>
              <p class="text-cyan-300 text-sm mt-3">Lines</p>
              <p class="text-2xl font-bold text-cyan-400" id="nbLines">0</p>
              <p class="text-cyan-300 text-sm mt-3">Next</p>
              <canvas id="nbNext" width="100" height="100" style="border:1px solid #06b6d4;border-radius:8px;background:#000a14;"></canvas>
            </div>
          </div>
          <div class="flex justify-center gap-2 mt-3 md:hidden">
            <button onclick="nbMove('left')" class="bg-cyan-700 text-white px-4 py-2 rounded-lg">â¬…ï¸</button>
            <button onclick="nbMove('rotate')" class="bg-cyan-700 text-white px-4 py-2 rounded-lg">ğŸ”„</button>
            <button onclick="nbMove('right')" class="bg-cyan-700 text-white px-4 py-2 rounded-lg">â¡ï¸</button>
            <button onclick="nbMove('drop')" class="bg-cyan-700 text-white px-4 py-2 rounded-lg">â¬‡ï¸</button>
          </div>
        </div>`;

      const canvas = document.getElementById('nbCanvas');
      const ctx = canvas.getContext('2d');
      const nextCanvas = document.getElementById('nbNext');
      const nextCtx = nextCanvas.getContext('2d');
      const COLS = 10, ROWS = 20, CELL = 25;
      const board = Array.from({ length: ROWS }, () => Array(COLS).fill(0));
      let score = 0, lines = 0, level = 1;
      let running = true;
      let particles = [];

      const PIECES = [
        { shape: [[1,1,1,1]], color: '#06b6d4', emoji: 'ğŸ’¦' },           // I
        { shape: [[1,1],[1,1]], color: '#fbbf24', emoji: 'ğŸ‘' },          // O
        { shape: [[0,1,0],[1,1,1]], color: '#a855f7', emoji: 'ğŸ†' },      // T
        { shape: [[1,0],[1,0],[1,1]], color: '#f97316', emoji: 'ğŸ‘…' },     // L
        { shape: [[0,1],[0,1],[1,1]], color: '#3b82f6', emoji: 'ğŸ’‹' },     // J
        { shape: [[0,1,1],[1,1,0]], color: '#10b981', emoji: 'ğŸ”¥' },      // S
        { shape: [[1,1,0],[0,1,1]], color: '#f43f5e', emoji: 'ğŸ˜ˆ' },      // Z
      ];

      function randomPiece() {
        const p = PIECES[Math.floor(Math.random() * PIECES.length)];
        return { shape: p.shape.map(r => [...r]), color: p.color, emoji: p.emoji, x: 3, y: 0 };
      }

      let current = randomPiece();
      let next = randomPiece();

      function rotate(shape) {
        const rows = shape.length, cols = shape[0].length;
        const rotated = Array.from({ length: cols }, () => Array(rows).fill(0));
        for (let r = 0; r < rows; r++)
          for (let c = 0; c < cols; c++)
            rotated[c][rows - 1 - r] = shape[r][c];
        return rotated;
      }

      function valid(piece, offsetX = 0, offsetY = 0) {
        for (let r = 0; r < piece.shape.length; r++) {
          for (let c = 0; c < piece.shape[r].length; c++) {
            if (!piece.shape[r][c]) continue;
            const nx = piece.x + c + offsetX;
            const ny = piece.y + r + offsetY;
            if (nx < 0 || nx >= COLS || ny >= ROWS) return false;
            if (ny >= 0 && board[ny][nx]) return false;
          }
        }
        return true;
      }

      function lock() {
        for (let r = 0; r < current.shape.length; r++) {
          for (let c = 0; c < current.shape[r].length; c++) {
            if (current.shape[r][c]) {
              const ny = current.y + r;
              const nx = current.x + c;
              if (ny < 0) { running = false; return; }
              board[ny][nx] = current.color;
            }
          }
        }

        // Check lines
        let cleared = 0;
        for (let r = ROWS - 1; r >= 0; r--) {
          if (board[r].every(c => c)) {
            // Line clear particles
            for (let c = 0; c < COLS; c++) {
              for (let i = 0; i < 5; i++) {
                particles.push({
                  x: c * CELL + CELL / 2, y: r * CELL + CELL / 2,
                  vx: (Math.random() - 0.5) * 8, vy: (Math.random() - 0.5) * 8,
                  life: 1, color: board[r][c], size: 4 + Math.random() * 4
                });
              }
            }
            board.splice(r, 1);
            board.unshift(Array(COLS).fill(0));
            cleared++;
            r++;
          }
        }

        if (cleared > 0) {
          const pts = [0, 100, 300, 500, 800][cleared] * level;
          score += pts;
          lines += cleared;
          level = Math.floor(lines / 5) + 1;
          document.getElementById('nbScore').textContent = score;
          document.getElementById('nbLines').textContent = lines;
          document.getElementById('nbLevel').textContent = level;
          screenShake(cleared * 3, 200);
          if (cleared >= 4) launchConfetti(50);
        }

        current = next;
        next = randomPiece();
        if (!valid(current)) {
          running = false;
          postScore('naughty_blocks', score);
          if (score >= 500) launchConfetti(80);
        }
      }

      window.nbMove = function(dir) {
        if (!running) return;
        if (dir === 'left' && valid(current, -1, 0)) current.x--;
        if (dir === 'right' && valid(current, 1, 0)) current.x++;
        if (dir === 'drop') { while (valid(current, 0, 1)) current.y++; lock(); }
        if (dir === 'rotate') {
          const rotated = rotate(current.shape);
          const old = current.shape;
          current.shape = rotated;
          if (!valid(current)) current.shape = old;
        }
      };

      document.addEventListener('keydown', e => {
        if (e.key === 'ArrowLeft') { e.preventDefault(); window.nbMove('left'); }
        if (e.key === 'ArrowRight') { e.preventDefault(); window.nbMove('right'); }
        if (e.key === 'ArrowDown') { e.preventDefault(); if (valid(current, 0, 1)) current.y++; }
        if (e.key === 'ArrowUp' || e.key === 'z') { e.preventDefault(); window.nbMove('rotate'); }
        if (e.code === 'Space') { e.preventDefault(); window.nbMove('drop'); }
      });

      function drawBlock(c, x, y, size, glow = false) {
        if (glow) { ctx.shadowBlur = 10; ctx.shadowColor = c; }
        ctx.fillStyle = c;
        ctx.fillRect(x + 1, y + 1, size - 2, size - 2);
        // Shine
        ctx.fillStyle = 'rgba(255,255,255,0.15)';
        ctx.fillRect(x + 2, y + 2, size - 4, size / 3);
        ctx.shadowBlur = 0;
      }

      function drawNext() {
        nextCtx.fillStyle = '#000a14';
        nextCtx.fillRect(0, 0, 100, 100);
        const s = 20;
        const ox = (100 - next.shape[0].length * s) / 2;
        const oy = (100 - next.shape.length * s) / 2;
        next.shape.forEach((row, r) => {
          row.forEach((cell, c) => {
            if (cell) {
              nextCtx.fillStyle = next.color;
              nextCtx.fillRect(ox + c * s + 1, oy + r * s + 1, s - 2, s - 2);
              nextCtx.fillStyle = 'rgba(255,255,255,0.15)';
              nextCtx.fillRect(ox + c * s + 2, oy + r * s + 2, s - 4, s / 3);
            }
          });
        });
      }

      let dropTimer = 0;
      function gameLoop() {
        if (!running) {
          ctx.fillStyle = 'rgba(0,0,0,0.8)';
          ctx.fillRect(0, 0, 250, 500);
          ctx.fillStyle = '#06b6d4';
          ctx.font = 'bold 28px sans-serif';
          ctx.textAlign = 'center';
          ctx.fillText('GAME OVER', 125, 230);
          ctx.font = '18px sans-serif';
          ctx.fillStyle = '#67e8f9';
          ctx.fillText(`Score: ${score}`, 125, 270);
          return;
        }

        dropTimer++;
        if (dropTimer >= Math.max(12, 45 - level * 3)) {
          dropTimer = 0;
          if (valid(current, 0, 1)) current.y++;
          else lock();
        }

        // Draw
        ctx.fillStyle = '#000a14';
        ctx.fillRect(0, 0, 250, 500);

        // Grid
        ctx.strokeStyle = 'rgba(6,182,212,0.08)';
        for (let r = 0; r < ROWS; r++)
          for (let c = 0; c < COLS; c++)
            ctx.strokeRect(c * CELL, r * CELL, CELL, CELL);

        // Board
        board.forEach((row, r) => {
          row.forEach((cell, c) => {
            if (cell) drawBlock(cell, c * CELL, r * CELL, CELL);
          });
        });

        // Ghost piece
        let ghostY = current.y;
        while (valid({ ...current, y: ghostY + 1 })) ghostY++;
        if (ghostY !== current.y) {
          ctx.globalAlpha = 0.2;
          current.shape.forEach((row, r) => {
            row.forEach((cell, c) => {
              if (cell) {
                ctx.fillStyle = current.color;
                ctx.fillRect((current.x + c) * CELL + 1, (ghostY + r) * CELL + 1, CELL - 2, CELL - 2);
              }
            });
          });
          ctx.globalAlpha = 1;
        }

        // Current piece with glow
        current.shape.forEach((row, r) => {
          row.forEach((cell, c) => {
            if (cell) drawBlock(current.color, (current.x + c) * CELL, (current.y + r) * CELL, CELL, true);
          });
        });

        // Particles
        particles = particles.filter(p => {
          p.x += p.vx; p.y += p.vy; p.life -= 0.03; p.vy += 0.15;
          ctx.globalAlpha = p.life;
          ctx.fillStyle = p.color;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.size * p.life, 0, Math.PI * 2);
          ctx.fill();
          return p.life > 0;
        });
        ctx.globalAlpha = 1;

        drawNext();
        requestAnimationFrame(gameLoop);
      }
      gameLoop();
    }

  </script>
{% endblock %}

